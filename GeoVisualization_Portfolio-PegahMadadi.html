<!DOCTYPE html>
<html lang='en'><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeoVisualization Portfolio</title>

    <!-- NEW: per-file autosave namespace -->
    <meta name="portfolio-id" content="4f58e8b3-3d80-44ff-8573-bc20309d4002">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

    <style>
        :root {
            --sidebar-width: 280px;
            --primary: #2c3e50;
            --accent: #27ae60;
            --danger: #e74c3c;
            --bg-color: #f8f9fa;
            --text-light: #ecf0f1;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            height: 100vh;
            overflow: hidden;
            background-color: var(--bg-color);
        }

        /* --- SIDEBAR --- */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--primary);
            color: var(--text-light);
            display: flex;
            flex-direction: column;
            padding: 20px;
            box-shadow: 4px 0 10px rgba(0, 0, 0, 0.2);
            z-index: 10;
        }

        .avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: #555;
            margin: 0 auto 10px;
            border: 3px solid var(--accent);
            overflow: hidden;
            position: relative;
        }

        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .nav-btn {
            background: transparent;
            border: none;
            color: #bdc3c7;
            text-align: left;
            padding: 15px;
            cursor: pointer;
            font-size: 1rem;
            transition: 0.3s;
            border-radius: 8px;
            width: 100%;
        }

        .nav-btn:hover,
        .nav-btn.active {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-left: 4px solid var(--accent);
        }

        /* --- MAIN CONTENT --- */
        .main-content {
            flex: 1;
            overflow-y: auto;
            position: relative;
            scroll-behavior: smooth;
            padding-bottom: 100px;
        }

        .page-section {
            display: none;
            padding: 40px;
        }

        .page-section.active {
            display: block;
            animation: fadeUp 0.5s ease;
        }

        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* --- WEEK BLOCKS --- */
        .week-block {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 50px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            position: relative;
            border-left: 6px solid var(--accent);
        }

        .week-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }

        .category-section {
            margin-top: 30px;
            margin-bottom: 20px;
        }

        .category-title {
            font-size: 1.1rem;
            color: #7f8c8d;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: bold;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 5px;
            margin-bottom: 15px;
            display: inline-block;
        }

        /* --- GALLERY GRID --- */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 15px;
        }

        .gallery-item {
            position: relative;
            border-radius: 12px;
            overflow: hidden;
            transition: 0.3s;
            display: flex;
            flex-direction: column;
            cursor: pointer;
        }

        .gallery-item:hover {
            transform: scale(1.02);
            z-index: 2;
        }

        .gallery-item:hover .img-container {
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .img-container {
            height: 200px;
            width: 100%;
            position: relative;
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            background: #eee;
        }

        .img-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: 0.5s;
        }

        .item-data {
            display: none;
        }

        body.editing .item-data {
            display: flex;
            flex-direction: column;
            background: #fafafa;
            border: 1px dashed #ccc;
            padding: 10px;
            margin-top: 5px;
        }

        body.editing .gallery-item {
            cursor: default;
            transform: none;
        }

        .gallery-item[data-type="text"] {
            background: white;
            border: 1px solid #eee;
            height: 200px;
            padding: 20px;
            box-sizing: border-box;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .gallery-item[data-type="text"] .item-data {
            display: block;
            height: 100%;
            overflow: hidden;
            mask-image: linear-gradient(to bottom, black 50%, transparent 100%);
        }

        .gallery-item[data-type="text"] .img-container {
            display: none;
        }

        /* --- EDITING UI --- */
        .delete-btn {
            display: none;
            background: var(--danger);
            color: white;
            border: none;
            padding: 5px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 0.8rem;
            position: absolute;
            top: 5px;
            right: 5px;
            z-index: 20;
        }

        .editing .delete-btn {
            display: block;
        }

        .add-area-small {
            display: none;
            text-align: center;
            border: 2px dashed #ddd;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            color: #aaa;
            margin-top: 10px;
        }

        .add-area-small:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .add-area-big {
            display: none;
            margin: 40px 0;
            border: 3px dashed #ccc;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            color: #777;
            border-radius: 15px;
            font-size: 1.5rem;
        }

        .add-area-big:hover {
            border-color: var(--accent);
            color: var(--accent);
        }

        .editing .add-area-small,
        .editing .add-area-big {
            display: block;
        }

        .file-upload-overlay {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            align-items: center;
            justify-content: center;
            z-index: 5;
        }

        .editing .file-upload-overlay {
            display: flex;
        }

        .editable-field {
            border: 1px dashed transparent;
            cursor: default;
        }

        .editing .editable-field {
            border: 1px dashed #f39c12;
            background: rgba(255, 255, 100, 0.1);
            cursor: text;
        }

        /* --- MODALS --- */
        #editor-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.5);
            z-index: 5000;
            justify-content: center;
            align-items: center;
        }

        #editor-modal.active {
            display: flex;
        }

        .editor-box {
            background: white;
            width: 800px;
            max-width: 90%;
            height: 80vh;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .editor-header {
            padding: 15px;
            background: #f8f9fa;
            border-bottom: 1px solid #ddd;
        }

        #quill-container {
            flex: 1;
            overflow-y: auto;
        }

        .editor-footer {
            padding: 15px;
            border-top: 1px solid #ddd;
            text-align: right;
            background: #f8f9fa;
        }

        .editor-btn {
            padding: 10px 20px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }

        .btn-cancel {
            background: #95a5a6;
            color: white;
            margin-right: 10px;
        }

        .btn-ok {
            background: var(--accent);
            color: white;
        }

        /* --- EXPORT MODAL --- */
        #export-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #1a1a1a;
            z-index: 6000;
            flex-direction: column;
        }

        #export-modal.active {
            display: flex;
        }

        .export-header {
            padding: 20px;
            background: #000;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
        }

        .export-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .export-select {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #444;
            background: #222;
            color: white;
            font-size: 0.9rem;
        }

        .export-grid {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .export-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            border: 3px solid transparent;
            opacity: 0.6;
            transition: 0.2s;
        }

        .export-item:hover {
            opacity: 1;
        }

        .export-item.selected {
            border-color: var(--accent);
            opacity: 1;
            transform: scale(0.95);
            box-shadow: 0 0 15px rgba(39, 174, 96, 0.5);
        }

        .export-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }

        .export-item .check-icon {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--accent);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: none;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .export-item.selected .check-icon {
            display: flex;
        }

        /* --- VIEW MODAL --- */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 3000;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.open {
            display: flex;
        }

        .modal-card {
            background: white;
            width: 90%;
            height: 90%;
            display: flex;
            border-radius: 15px;
            overflow: hidden;
        }

        .modal-viz {
            flex: 2;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-viz img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .modal-text {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
            border-left: 1px solid #eee;
            display: flex;
            flex-direction: column;
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 2rem;
            cursor: pointer;
        }

        .modal-card.text-only-mode .modal-viz {
            display: none;
        }

        .modal-card.text-only-mode .modal-text {
            flex: 1;
            padding: 60px;
            max-width: 800px;
            margin: 0 auto;
            border: none;
        }

        /* --- CONTROLS & TOAST --- */
        .controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 2000;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        button.ctrl-btn {
            padding: 12px 24px;
            border-radius: 30px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .btn-edit {
            background: var(--primary);
            color: white;
        }

        .btn-save {
            background: var(--accent);
            color: white;
            display: block;
        }

        .btn-export {
            background: #8e44ad;
            color: white;
        }

        .btn-reset {
            background: #e67e22;
            color: white;
            font-size: 0.8rem;
            padding: 12px 15px !important;
        }

        #autosave-toast {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            padding: 15px 20px;
            border-radius: 12px;
            font-size: 0.9rem;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            gap: 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            border-left: 5px solid #2ecc71;
            max-width: 300px;
        }

        #autosave-toast.visible {
            opacity: 1;
        }

        .toast-title {
            font-weight: bold;
            color: #2ecc71;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .toast-msg {
            font-size: 0.8rem;
            opacity: 0.9;
            color: #ddd;
        }
    </style>
</head>

<body class="">

    <div id="autosave-toast" class="">
        <div class="toast-title"><span>üíæ</span> Autosaved (Browser)</div>
        <div class="toast-msg">Don't forget to click "Save &amp; Download" to create a permanent file!</div>
    </div>

    <div id="export-modal">
        <div class="export-header">
            <div>
                <h2 style="margin:0;">Gallery Studio</h2>
                <small style="color:#aaa;">Select images &amp; layout style</small>
            </div>
            <div class="export-controls">
                <select id="export-layout" class="export-select">
                    <option value="dynamic" selected="">Layout: Smart Mosaic (Flush Rows)</option>
                    <option value="uniform">Layout: Uniform Grid (Cropped)</option>
                </select>
                <button class="editor-btn btn-cancel" onclick="closeExportModal()">Close</button>
                <button class="editor-btn btn-ok" onclick="generateGallery()">‚¨áÔ∏è Download HTML</button>
            </div>
        </div>
        <div class="export-grid" id="export-grid-content"></div>
    </div>

    <div id="editor-modal" class="">
        <div class="editor-box">
            <div class="editor-header">
                <h3>Editing Text</h3>
            </div>
            <div class="ql-toolbar ql-snow"><span class="ql-formats"><span class="ql-header ql-picker"><span class="ql-picker-label" tabindex="0" role="button" aria-expanded="false" aria-controls="ql-picker-options-0"><svg viewBox="0 0 18 18"> <polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"></polygon> <polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"></polygon> </svg></span><span class="ql-picker-options" aria-hidden="true" tabindex="-1" id="ql-picker-options-0"><span tabindex="0" role="button" class="ql-picker-item" data-value="1"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="2"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="3"></span><span tabindex="0" role="button" class="ql-picker-item"></span></span></span><select class="ql-header" style="display: none;"><option value="1"></option><option value="2"></option><option value="3"></option><option selected="selected"></option></select></span><span class="ql-formats"><button type="button" class="ql-bold"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"></path> <path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"></path> </svg></button><button type="button" class="ql-italic"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"></line> <line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"></line> <line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"></line> </svg></button><button type="button" class="ql-underline"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"></path> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"></rect> </svg></button><button type="button" class="ql-strike"><svg viewBox="0 0 18 18"> <line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"></line> <path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"></path> <path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"></path> </svg></button></span><span class="ql-formats"><button type="button" class="ql-list" value="ordered"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"></line> <line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"></line> <path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"></path> <path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"></path> <path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"></path> </svg></button><button type="button" class="ql-list" value="bullet"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"></line> <line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"></line> <line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"></line> <line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"></line> </svg></button></span><span class="ql-formats"><button type="button" class="ql-link"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"></line> <path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"></path> <path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"></path> </svg></button><button type="button" class="ql-clean"><svg class="" viewBox="0 0 18 18"> <line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"></line> <line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"></line> <line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"></line> <line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"></line> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"></rect> </svg></button></span></div><div class="ql-toolbar ql-snow"><span class="ql-formats"><span class="ql-header ql-picker"><span class="ql-picker-label" tabindex="0" role="button" aria-expanded="false" aria-controls="ql-picker-options-0"><svg viewBox="0 0 18 18"> <polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"></polygon> <polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"></polygon> </svg></span><span class="ql-picker-options" aria-hidden="true" tabindex="-1" id="ql-picker-options-0"><span tabindex="0" role="button" class="ql-picker-item" data-value="1"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="2"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="3"></span><span tabindex="0" role="button" class="ql-picker-item"></span></span></span><select class="ql-header" style="display: none;"><option value="1"></option><option value="2"></option><option value="3"></option><option selected="selected"></option></select></span><span class="ql-formats"><button type="button" class="ql-bold"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"></path> <path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"></path> </svg></button><button type="button" class="ql-italic"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"></line> <line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"></line> <line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"></line> </svg></button><button type="button" class="ql-underline"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"></path> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"></rect> </svg></button><button type="button" class="ql-strike"><svg viewBox="0 0 18 18"> <line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"></line> <path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"></path> <path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"></path> </svg></button></span><span class="ql-formats"><button type="button" class="ql-list" value="ordered"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"></line> <line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"></line> <path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"></path> <path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"></path> <path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"></path> </svg></button><button type="button" class="ql-list" value="bullet"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"></line> <line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"></line> <line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"></line> <line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"></line> </svg></button></span><span class="ql-formats"><button type="button" class="ql-link"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"></line> <path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"></path> <path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"></path> </svg></button><button type="button" class="ql-clean"><svg class="" viewBox="0 0 18 18"> <line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"></line> <line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"></line> <line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"></line> <line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"></line> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"></rect> </svg></button></span></div><div class="ql-toolbar ql-snow"><span class="ql-formats"><span class="ql-header ql-picker"><span class="ql-picker-label" tabindex="0" role="button" aria-expanded="false" aria-controls="ql-picker-options-0"><svg viewBox="0 0 18 18"> <polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"></polygon> <polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"></polygon> </svg></span><span class="ql-picker-options" aria-hidden="true" tabindex="-1" id="ql-picker-options-0"><span tabindex="0" role="button" class="ql-picker-item" data-value="1"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="2"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="3"></span><span tabindex="0" role="button" class="ql-picker-item"></span></span></span><select class="ql-header" style="display: none;"><option value="1"></option><option value="2"></option><option value="3"></option><option selected="selected"></option></select></span><span class="ql-formats"><button type="button" class="ql-bold"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"></path> <path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"></path> </svg></button><button type="button" class="ql-italic"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"></line> <line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"></line> <line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"></line> </svg></button><button type="button" class="ql-underline"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"></path> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"></rect> </svg></button><button type="button" class="ql-strike"><svg viewBox="0 0 18 18"> <line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"></line> <path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"></path> <path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"></path> </svg></button></span><span class="ql-formats"><button type="button" class="ql-list" value="ordered"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"></line> <line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"></line> <path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"></path> <path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"></path> <path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"></path> </svg></button><button type="button" class="ql-list" value="bullet"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"></line> <line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"></line> <line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"></line> <line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"></line> </svg></button></span><span class="ql-formats"><button type="button" class="ql-link"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"></line> <path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"></path> <path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"></path> </svg></button><button type="button" class="ql-clean"><svg class="" viewBox="0 0 18 18"> <line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"></line> <line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"></line> <line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"></line> <line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"></line> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"></rect> </svg></button></span></div><div class="ql-toolbar ql-snow"><span class="ql-formats"><span class="ql-header ql-picker"><span class="ql-picker-label" tabindex="0" role="button" aria-expanded="false" aria-controls="ql-picker-options-0"><svg viewBox="0 0 18 18"> <polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"></polygon> <polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"></polygon> </svg></span><span class="ql-picker-options" aria-hidden="true" tabindex="-1" id="ql-picker-options-0"><span tabindex="0" role="button" class="ql-picker-item" data-value="1"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="2"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="3"></span><span tabindex="0" role="button" class="ql-picker-item"></span></span></span><select class="ql-header" style="display: none;"><option value="1"></option><option value="2"></option><option value="3"></option><option selected="selected"></option></select></span><span class="ql-formats"><button type="button" class="ql-bold"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"></path> <path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"></path> </svg></button><button type="button" class="ql-italic"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"></line> <line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"></line> <line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"></line> </svg></button><button type="button" class="ql-underline"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"></path> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"></rect> </svg></button><button type="button" class="ql-strike"><svg viewBox="0 0 18 18"> <line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"></line> <path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"></path> <path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"></path> </svg></button></span><span class="ql-formats"><button type="button" class="ql-list" value="ordered"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"></line> <line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"></line> <path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"></path> <path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"></path> <path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"></path> </svg></button><button type="button" class="ql-list" value="bullet"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"></line> <line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"></line> <line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"></line> <line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"></line> </svg></button></span><span class="ql-formats"><button type="button" class="ql-link"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"></line> <path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"></path> <path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"></path> </svg></button><button type="button" class="ql-clean"><svg class="" viewBox="0 0 18 18"> <line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"></line> <line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"></line> <line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"></line> <line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"></line> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"></rect> </svg></button></span></div><div class="ql-toolbar ql-snow"><span class="ql-formats"><span class="ql-header ql-picker"><span class="ql-picker-label" tabindex="0" role="button" aria-expanded="false" aria-controls="ql-picker-options-0"><svg viewBox="0 0 18 18"> <polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"></polygon> <polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"></polygon> </svg></span><span class="ql-picker-options" aria-hidden="true" tabindex="-1" id="ql-picker-options-0"><span tabindex="0" role="button" class="ql-picker-item" data-value="1"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="2"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="3"></span><span tabindex="0" role="button" class="ql-picker-item"></span></span></span><select class="ql-header" style="display: none;"><option value="1"></option><option value="2"></option><option value="3"></option><option selected="selected"></option></select></span><span class="ql-formats"><button type="button" class="ql-bold"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"></path> <path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"></path> </svg></button><button type="button" class="ql-italic"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"></line> <line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"></line> <line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"></line> </svg></button><button type="button" class="ql-underline"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"></path> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"></rect> </svg></button><button type="button" class="ql-strike"><svg viewBox="0 0 18 18"> <line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"></line> <path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"></path> <path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"></path> </svg></button></span><span class="ql-formats"><button type="button" class="ql-list" value="ordered"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"></line> <line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"></line> <path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"></path> <path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"></path> <path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"></path> </svg></button><button type="button" class="ql-list" value="bullet"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"></line> <line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"></line> <line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"></line> <line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"></line> </svg></button></span><span class="ql-formats"><button type="button" class="ql-link"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"></line> <path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"></path> <path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"></path> </svg></button><button type="button" class="ql-clean"><svg class="" viewBox="0 0 18 18"> <line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"></line> <line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"></line> <line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"></line> <line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"></line> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"></rect> </svg></button></span></div><div class="ql-toolbar ql-snow"><span class="ql-formats"><span class="ql-header ql-picker"><span class="ql-picker-label" tabindex="0" role="button" aria-expanded="false" aria-controls="ql-picker-options-0"><svg viewBox="0 0 18 18"> <polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"></polygon> <polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"></polygon> </svg></span><span class="ql-picker-options" aria-hidden="true" tabindex="-1" id="ql-picker-options-0"><span tabindex="0" role="button" class="ql-picker-item" data-value="1"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="2"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="3"></span><span tabindex="0" role="button" class="ql-picker-item"></span></span></span><select class="ql-header" style="display: none;"><option value="1"></option><option value="2"></option><option value="3"></option><option selected="selected"></option></select></span><span class="ql-formats"><button type="button" class="ql-bold"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"></path> <path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"></path> </svg></button><button type="button" class="ql-italic"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"></line> <line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"></line> <line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"></line> </svg></button><button type="button" class="ql-underline"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"></path> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"></rect> </svg></button><button type="button" class="ql-strike"><svg viewBox="0 0 18 18"> <line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"></line> <path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"></path> <path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"></path> </svg></button></span><span class="ql-formats"><button type="button" class="ql-list" value="ordered"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"></line> <line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"></line> <path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"></path> <path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"></path> <path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"></path> </svg></button><button type="button" class="ql-list" value="bullet"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"></line> <line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"></line> <line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"></line> <line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"></line> </svg></button></span><span class="ql-formats"><button type="button" class="ql-link"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"></line> <path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"></path> <path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"></path> </svg></button><button type="button" class="ql-clean"><svg class="" viewBox="0 0 18 18"> <line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"></line> <line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"></line> <line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"></line> <line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"></line> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"></rect> </svg></button></span></div><div class="ql-toolbar ql-snow"><span class="ql-formats"><span class="ql-header ql-picker"><span class="ql-picker-label" tabindex="0" role="button" aria-expanded="false" aria-controls="ql-picker-options-0" data-value="3"><svg viewBox="0 0 18 18"> <polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"></polygon> <polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"></polygon> </svg></span><span class="ql-picker-options" aria-hidden="true" tabindex="-1" id="ql-picker-options-0"><span tabindex="0" role="button" class="ql-picker-item" data-value="1"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="2"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="3"></span><span tabindex="0" role="button" class="ql-picker-item"></span></span></span><select class="ql-header" style="display: none;"><option value="1"></option><option value="2"></option><option value="3"></option><option selected="selected"></option></select></span><span class="ql-formats"><button type="button" class="ql-bold"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"></path> <path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"></path> </svg></button><button type="button" class="ql-italic"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"></line> <line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"></line> <line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"></line> </svg></button><button type="button" class="ql-underline"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"></path> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"></rect> </svg></button><button type="button" class="ql-strike"><svg viewBox="0 0 18 18"> <line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"></line> <path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"></path> <path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"></path> </svg></button></span><span class="ql-formats"><button type="button" class="ql-list" value="ordered"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"></line> <line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"></line> <path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"></path> <path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"></path> <path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"></path> </svg></button><button type="button" class="ql-list" value="bullet"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"></line> <line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"></line> <line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"></line> <line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"></line> </svg></button></span><span class="ql-formats"><button type="button" class="ql-link"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"></line> <path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"></path> <path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"></path> </svg></button><button type="button" class="ql-clean"><svg class="" viewBox="0 0 18 18"> <line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"></line> <line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"></line> <line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"></line> <line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"></line> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"></rect> </svg></button></span></div><div class="ql-toolbar ql-snow"><span class="ql-formats"><span class="ql-header ql-picker"><span class="ql-picker-label" tabindex="0" role="button" aria-expanded="false" aria-controls="ql-picker-options-0"><svg viewBox="0 0 18 18"> <polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"></polygon> <polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"></polygon> </svg></span><span class="ql-picker-options" aria-hidden="true" tabindex="-1" id="ql-picker-options-0"><span tabindex="0" role="button" class="ql-picker-item" data-value="1"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="2"></span><span tabindex="0" role="button" class="ql-picker-item" data-value="3"></span><span tabindex="0" role="button" class="ql-picker-item"></span></span></span><select class="ql-header" style="display: none;"><option value="1"></option><option value="2"></option><option value="3"></option><option selected="selected"></option></select></span><span class="ql-formats"><button type="button" class="ql-bold"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"></path> <path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"></path> </svg></button><button type="button" class="ql-italic"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"></line> <line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"></line> <line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"></line> </svg></button><button type="button" class="ql-underline"><svg viewBox="0 0 18 18"> <path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"></path> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"></rect> </svg></button><button type="button" class="ql-strike"><svg viewBox="0 0 18 18"> <line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"></line> <path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"></path> <path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"></path> </svg></button></span><span class="ql-formats"><button type="button" class="ql-list" value="ordered"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"></line> <line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"></line> <path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"></path> <path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"></path> <path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"></path> </svg></button><button type="button" class="ql-list" value="bullet"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"></line> <line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"></line> <line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"></line> <line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"></line> <line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"></line> <line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"></line> </svg></button></span><span class="ql-formats"><button type="button" class="ql-link"><svg viewBox="0 0 18 18"> <line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"></line> <path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"></path> <path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"></path> </svg></button><button type="button" class="ql-clean"><svg class="" viewBox="0 0 18 18"> <line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"></line> <line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"></line> <line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"></line> <line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"></line> <rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"></rect> </svg></button></span></div><div id="quill-container" class="ql-container ql-snow"><div class="ql-editor" data-gramm="false" contenteditable="true"><p>Bivariate choropleth map + bivariate legend/key</p></div><div class="ql-clipboard" contenteditable="true" tabindex="-1"></div><div class="ql-tooltip ql-hidden"><a class="ql-preview" target="_blank" href="about:blank"></a><input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL"><a class="ql-action"></a><a class="ql-remove"></a></div></div>
            <div class="editor-footer">
                <button class="editor-btn btn-cancel" onclick="closeEditor(false)">Cancel</button>
                <button class="editor-btn btn-ok" onclick="closeEditor(true)">Save Changes</button>
            </div>
        </div>
    </div>

    <div class="sidebar">
        <div class="profile-area" id="profile-container">
            <div class="avatar">
                <img id="avatar-img" src="image.jpg" alt="Avatar">
                <label class="file-upload-overlay" style="cursor: pointer;">
                    Change <input type="file" hidden="" onchange="updateSrc(this, 'avatar-img')">
                </label>
            </div>
            <div class="editable-field" style="margin-top:10px; font-weight:bold; font-size:1.2rem;" onclick="openEditor(this)"><p><br></p></div>
            <div class="editable-field" style="font-size:0.9rem; opacity:0.8;" onclick="openEditor(this)">Spring
                Semester 2026</div>
        </div>
        <button class="nav-btn active" onclick="switchTab('gallery')">üìÖ Weekly Timeline</button>
        <button class="nav-btn" onclick="switchTab('maps')">üåç Final Maps</button>
        <button class="nav-btn" onclick="switchTab('about')">üë§ About Me</button>
    </div>

    <div class="main-content">
        <div id="gallery" class="page-section active">
            <h1 class="editable-field" onclick="openEditor(this)">Course Gallery</h1>
            <div id="timeline-container"><div class="week-block" id="week-1">
                <div class="week-header">
                    <h2 class="editable-field" onclick="openEditor(this)">Week 1</h2>
                    <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è Delete Week</button>
                </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üíª Labs &amp; Exercises</div>
                <div class="gallery-grid"><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="test1.jpg" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)">Title</h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="test2.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)">Title</h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="test3.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)">Title</h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üìä Good vs Bad Viz</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üìñ Reading Reflections</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'text')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üöÄ Project Progress</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üí¨ Peer Review &amp; Extras</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
            </div><div class="week-block" id="week-2">
                <div class="week-header">
                    <h2 class="editable-field" onclick="openEditor(this)">Week 2</h2>
                    <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è Delete Week</button>
                </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üíª Labs &amp; Exercises</div>
                <div class="gallery-grid"><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Topic 1.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Creating Urban Heat Island Visualizations for Charlotte, Seattle, and New York City</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p><strong>Claim:</strong> <em>Urbanization influences urban heat island intensity differently across cities with contrasting climatic and geographic characteristics.</em></p><p><strong>Audience + Task:</strong> <em>Enable researchers, planners, and students to identify and compare spatial hotspot patterns across cities, considering factors such as temperature and wind conditions.</em></p><p><strong>Data + License:</strong> <em>U.S. Environmental Protection Agency (EPA); U.S. Geological Survey (USGS) datasets (land surface temperature, land cover, vegetation indices, etc.).</em></p><p><strong>Static Idea:</strong> <em>Side-by-side map layout comparing the three cities using a consistent color scheme.</em></p><p><strong>Interactive Idea:</strong> <em>Dynamic maps that allow users to explore and compare urban heat island hotspots across cities.</em></p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Topic 1..png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Creating Urban Heat Island Visualizations for Charlotte, Seattle, and New York City</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p><strong>Claim:</strong> <em>Urbanization influences urban heat island intensity differently across cities with contrasting climatic and geographic characteristics.</em></p><p><strong>Audience + Task:</strong> <em>Enable researchers, planners, and students to identify and compare spatial hotspot patterns across cities, considering factors such as temperature and wind conditions.</em></p><p><strong>Data + License:</strong> <em>U.S. Environmental Protection Agency (EPA); U.S. Geological Survey (USGS) datasets (land surface temperature, land cover, vegetation indices, etc.).</em></p><p><strong>Static Idea:</strong> <em>Side-by-side map layout comparing the three cities using a consistent color scheme.</em></p><p><strong>Interactive Idea:</strong> <em>Dynamic maps that allow users to explore and compare urban heat island hotspots across cities.</em></p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Topic 1...png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Creating Urban Heat Island Visualizations for Charlotte, Seattle, and New York City</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p><strong>Claim:</strong> <em>Urbanization influences urban heat island intensity differently across cities with contrasting climatic and geographic characteristics.</em></p><p><strong>Audience + Task:</strong> <em>Enable researchers, planners, and students to identify and compare spatial hotspot patterns across cities, considering factors such as temperature and wind conditions.</em></p><p><strong>Data + License:</strong> <em>U.S. Environmental Protection Agency (EPA); U.S. Geological Survey (USGS) datasets (land surface temperature, land cover, vegetation indices, etc.).</em></p><p><strong>Static Idea:</strong> <em>Side-by-side map layout comparing the three cities using a consistent color scheme.</em></p><p><strong>Interactive Idea:</strong> <em>Dynamic maps that allow users to explore and compare urban heat island hotspots across cities.</em></p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Topic 2.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Urban Heat Island Intensity in Charlotte Over the Last 20 Years (2010, 2015, 2020, 2025)</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p><strong>Claim:</strong> <em>This project focuses on urbanization within a single city to examine how impervious surfaces and land-use change influence urban heat island (UHI) intensity, rather than comparing temperature and wind across multiple cities.</em></p><p><strong>Audience + Task:</strong> <em>Researchers, planners, and students tasked with understanding how, and to what extent impervious surfaces and urbanization affect UHI patterns in Charlotte.</em></p><p><strong>Data + License:</strong> <em>North Carolina Data Portal; City of Charlotte Open Data Portal (land surface temperature, land cover, vegetation indices, etc.).</em></p><p><strong>Static Idea:</strong> <em>Side-by-side map layout showing four time periods (2010, 2015, 2020, 2025) using a consistent color scheme.</em></p><p><strong>Interactive Idea:</strong> <em>Dynamic maps that allow users to explore UHI hotspots alongside urbanization and impervious surface layers.</em></p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Topic 2..png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Urban Heat Island Intensity in Charlotte Over the Last 20 Years (2010, 2015, 2020, 2025)</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p><strong>Claim:</strong> <em>This project focuses on urbanization within a single city to examine how impervious surfaces and land-use change influence urban heat island (UHI) intensity, rather than comparing temperature and wind across multiple cities.</em></p><p><strong>Audience + Task:</strong> <em>Researchers, planners, and students tasked with understanding how, and to what extent impervious surfaces and urbanization affect UHI patterns in Charlotte.</em></p><p><strong>Data + License:</strong> <em>North Carolina Data Portal; City of Charlotte Open Data Portal (land surface temperature, land cover, vegetation indices, etc.).</em></p><p><strong>Static Idea:</strong> <em>Side-by-side map layout showing four time periods (2010, 2015, 2020, 2025) using a consistent color scheme.</em></p><p><strong>Interactive Idea:</strong> <em>Dynamic maps that allow users to explore UHI hotspots alongside urbanization and impervious surface layers.</em></p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Topic 2...png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Urban Heat Island Intensity in Charlotte Over the Last 20 Years (2010, 2015, 2020, 2025)</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p><strong>Claim:</strong> <em>This project focuses on urbanization within a single city to examine how impervious surfaces and land-use change influence urban heat island (UHI) intensity, rather than comparing temperature and wind across multiple cities.</em></p><p><strong>Audience + Task:</strong> <em>Researchers, planners, and students tasked with understanding how, and to what extent impervious surfaces and urbanization affect UHI patterns in Charlotte.</em></p><p><strong>Data + License:</strong> <em>North Carolina Data Portal; City of Charlotte Open Data Portal (land surface temperature, land cover, vegetation indices, etc.).</em></p><p><strong>Static Idea:</strong> <em>Side-by-side map layout showing four time periods (2010, 2015, 2020, 2025) using a consistent color scheme.</em></p><p><strong>Interactive Idea:</strong> <em>Dynamic maps that allow users to explore UHI hotspots alongside urbanization and impervious surface layers.</em></p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Topic 3.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p><em>Flood Risk and Vegetation Cover in Three U.S. Cities (Phoenix, Miami, and New York City)</em></p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p><strong>Claim:</strong> <em>There is a relationship between vegetation cover and flood risk across cities with different climatic characteristics.</em></p><p><strong>Audience + Task:</strong> <em>Researchers, planners, and students analyzing differences in flood risk and vegetation patterns among cities with contrasting climates.</em></p><p><strong>Data + License:</strong> <em>FEMA Flood Maps / National Flood Hazard Layer (NFHL); National Land Cover Database (NLCD) ‚Äì USGS.</em></p><p><strong>Static Idea:</strong> <em>Side-by-side four-panel map layout comparing the three cities using a consistent color scheme.</em></p><p><strong>Interactive Idea:</strong> <em>Dynamic maps allowing users to explore flood-prone areas and vegetation cover layers for each city.</em></p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Gemini_Generated_Image_pg264opg264opg26.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p><em>Flood Risk and Vegetation Cover in Three U.S. Cities (Phoenix, Miami, and New York City)</em></p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p><strong>Claim:</strong> <em>There is a relationship between vegetation cover and flood risk across cities with different climatic characteristics.</em></p><p><strong>Audience + Task:</strong> <em>Researchers, planners, and students analyzing differences in flood risk and vegetation patterns among cities with contrasting climates.</em></p><p><strong>Data + License:</strong> <em>FEMA Flood Maps / National Flood Hazard Layer (NFHL); National Land Cover Database (NLCD) ‚Äì USGS.</em></p><p><strong>Static Idea:</strong> <em>Side-by-side four-panel map layout comparing the three cities using a consistent color scheme.</em></p><p><strong>Interactive Idea:</strong> <em>Dynamic maps allowing users to explore flood-prone areas and vegetation cover layers for each city.</em></p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üìä Good vs Bad Viz</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üìñ Reading Reflections</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'text')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üöÄ Project Progress</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üí¨ Peer Review &amp; Extras</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
            </div><div class="week-block" id="week-3">
                <div class="week-header">
                    <h2 class="editable-field" onclick="openEditor(this)">Week 3</h2>
                    <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è Delete Week</button>
                </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üíª Labs &amp; Exercises</div>
                <div class="gallery-grid"><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Screenshot 2026-01-27 150338.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Title</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Screenshot 2026-01-27 150413.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)">Title</h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Screenshot 2026-01-27 150542.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)">Title</h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Screenshot 2026-01-27 150610.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)">Title</h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Screenshot 2026-01-27 151447.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Title</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Screenshot 2026-01-27 152435.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)">Title</h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Screenshot 2026-01-27 152505.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)">Title</h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="Screenshot 2026-01-27 152800.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Title</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üìä Good vs Bad Viz</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üìñ Reading Reflections</div>
                <div class="gallery-grid"><div class="gallery-item" data-type="text" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Lab 2: Conda + Jupyter</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>This was my first time working with this kind of Python setup, so compared to R it was a new experience for me. At first, the commands and environment setup were a bit confusing, but completing this lab helped me better understand how conda environments and JupyterLab work. I was able to set everything up successfully and run the sanity-check script without errors. Through this process, I became more familiar with managing environments and packages. I expect that by completing more upcoming labs, I will become more confident and professional in using these tools for geovisualization work.</p></div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'text')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üöÄ Project Progress</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üí¨ Peer Review &amp; Extras</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
            </div><div class="week-block" id="week-4">
                <div class="week-header">
                    <h2 class="editable-field" onclick="openEditor(this)">Week 4</h2>
                    <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è Delete Week</button>
                </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üíª Labs &amp; Exercises</div>
                <div class="gallery-grid"><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="S1.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>S1</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>EarthExplorer: Search Criteria page showing your AOI + date range.</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="S2.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>S2</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>EarthExplorer: Data Sets page showing the dataset(s) you selected (e.g., Landsat Collection 2 Level-2).</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="S3.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>S3</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>EarthExplorer: Results list showing at least one scene selected (include cloud cover/preview).</p><p><br></p><p>(The preview images are not displaying correctly as they normally do. It might be due to an internet connection issue.)</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="S4.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>S4</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>EarthExplorer: Download Options page (or your browser downloads list) showing the file is downloading or downloaded.</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="S5.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>S5</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>GEE access: Code Editor opens successfully OR a confirmation that your account is enabled (any clear proof).</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="S6.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>S6</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>JupyterLab: geemap map showing ROI + an imagery layer (e.g., Sentinel-2 RGB).</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="S7.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>S7</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>JupyterLab: NDVI layer visible with a colorbar/legend.</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="S8.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>S8</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>JupyterLab: NDVI data export to google drive (Optional)</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üìä Good vs Bad Viz</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üìñ Reading Reflections</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'text')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üöÄ Project Progress</div>
                <div class="gallery-grid"><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="IMG_7865.jpeg" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)">Title</h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="IMG_7866.jpeg" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)">Title</h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="IMG_7867.jpeg" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)">Title</h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üí¨ Peer Review &amp; Extras</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
            </div><div class="week-block" id="week-5">
                <div class="week-header">
                    <h2 class="editable-field" onclick="openEditor(this)">Week 5</h2>
                    <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è Delete Week</button>
                </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üíª Labs &amp; Exercises</div>
                <div class="gallery-grid"><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="1.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>1.Successful imports + package versions (GeoPandas, rasterio)</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>conda activate geoviz</p><p>python -c "import geopandas, rasterio, numpy, pandas; print('OK')"</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="2,1.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>2.Vector inspection output: CRS + total_bounds + a preview of columns/head()</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p><br></p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="2,2.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>2.Vector inspection output: CRS + total_bounds + a preview of columns/head()</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="3,1.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>3.Map preview: study boundary + clipped vector layer</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Reproject to Working CRS (Meters) and Clip Parks to Study Area</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="3,2.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>3.Map preview: study boundary + clipped vector layer</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Summary Statistic (Number of parks in study area)</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="3,3.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>3.Map preview: study boundary + clipped vector layer</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Export Clipped Parks Layer</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="3,4.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>3.Map preview: study boundary + clipped vector layer</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Quick Vector Map Preview</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="4.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>4.Raster metadata output: CRS + transform + bounds + nodata + resolution</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Open and Inspect Raster Metadata (LST)</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="5.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>5.Raster preview plot (full raster)</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Raster Preview + Stats</p><p><br></p><p>import matplotlib.pyplot as plt</p><p>with rasterio.open(lst_path) as src:</p><p>&nbsp;&nbsp;band1 = src.read(1)</p><p>&nbsp;&nbsp;nod = src.nodata</p><p>&nbsp;&nbsp;data = np.where(band1 == nod, np.nan, band1)</p><p>&nbsp;&nbsp;print("LST min/mean/max:",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.nanmin(data),</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.nanmean(data),</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.nanmax(data))</p><p>&nbsp;&nbsp;plt.figure(figsize=(8,6))</p><p>&nbsp;&nbsp;plt.imshow(band1)</p><p>&nbsp;&nbsp;plt.title("LST Raster Preview")</p><p>&nbsp;&nbsp;plt.axis("off")</p><p>&nbsp;&nbsp;plt.show()</p><p><br></p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="6.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>6.Masked/clipped raster preview plot + nodata-aware min/mean/max</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="6,1.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>6.Masked/clipped raster preview plot + nodata-aware min/mean/max</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><h3><strong>Clipped LST Raster</strong></h3><p><br></p><p>import numpy as np</p><p>import matplotlib.pyplot as plt</p><p><br></p><p>def preview_raster(raster_path, title="Raster Preview"):</p><p>&nbsp;&nbsp;with rasterio.open(raster_path) as src:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;band1 = src.read(1)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;nod = src.nodata</p><p>&nbsp;&nbsp;&nbsp;&nbsp;data = np.where(band1 == nod, np.nan, band1)</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;print(f"{title} min/mean/max:",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.nanmin(data),</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.nanmean(data),</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.nanmax(data))</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(8,6))</p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.imshow(data)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.title(title)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.show()</p><p><br></p><p># Example: preview LST</p><p>preview_raster(lst_clipped, "Clipped LST Raster")</p><p># Then preview NDVI / Albedo similarly</p><p>preview_raster(ndvi_clipped, "Clipped NDVI Raster")</p><p>preview_raster(albedo_clipped, "Clipped Albedo Raster")</p><p><br></p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="6,2.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>6.Masked/clipped raster preview plot + nodata-aware min/mean/max</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><h3><strong>Clipped NDVI Raster</strong></h3><p><br></p><p>import numpy as np</p><p>import matplotlib.pyplot as plt</p><p><br></p><p>def preview_raster(raster_path, title="Raster Preview"):</p><p>&nbsp;&nbsp;with rasterio.open(raster_path) as src:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;band1 = src.read(1)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;nod = src.nodata</p><p>&nbsp;&nbsp;&nbsp;&nbsp;data = np.where(band1 == nod, np.nan, band1)</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;print(f"{title} min/mean/max:",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.nanmin(data),</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.nanmean(data),</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.nanmax(data))</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(8,6))</p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.imshow(data)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.title(title)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.show()</p><p><br></p><p># Example: preview LST</p><p>preview_raster(lst_clipped, "Clipped LST Raster")</p><p># Then preview NDVI / Albedo similarly</p><p>preview_raster(ndvi_clipped, "Clipped NDVI Raster")</p><p>preview_raster(albedo_clipped, "Clipped Albedo Raster")</p><p><br></p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="6,3.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>6.Masked/clipped raster preview plot + nodata-aware min/mean/max</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><h3><strong>Clipped LST Raster</strong></h3><p><br></p><p>import numpy as np</p><p>import matplotlib.pyplot as plt</p><p><br></p><p>def preview_raster(raster_path, title="Raster Preview"):</p><p>&nbsp;&nbsp;with rasterio.open(raster_path) as src:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;band1 = src.read(1)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;nod = src.nodata</p><p>&nbsp;&nbsp;&nbsp;&nbsp;data = np.where(band1 == nod, np.nan, band1)</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;print(f"{title} min/mean/max:",</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.nanmin(data),</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.nanmean(data),</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;np.nanmax(data))</p><p><br></p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.figure(figsize=(8,6))</p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.imshow(data)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.title(title)</p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.axis("off")</p><p>&nbsp;&nbsp;&nbsp;&nbsp;plt.show()</p><p><br></p><p># Example: preview LST</p><p>preview_raster(lst_clipped, "Clipped LST Raster")</p><p># Then preview NDVI / Albedo similarly</p><p>preview_raster(ndvi_clipped, "Clipped NDVI Raster")</p><p>preview_raster(albedo_clipped, "Clipped Albedo Raster")</p><p><br></p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="7.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>7.Points sampling output: first 5 rows showing sampled values</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="8.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>8.Final check: map of sampled points (colored) on top of the study boundary</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="9.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>9.File explorer screenshot showing your outputs/ folder contains exported files</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üìä Good vs Bad Viz</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üìñ Reading Reflections</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'text')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üöÄ Project Progress</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üí¨ Peer Review &amp; Extras</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
            </div><div class="week-block" id="week-6">
                <div class="week-header">
                    <h2 class="editable-field" onclick="openEditor(this)">Week 6</h2>
                    <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è Delete Week</button>
                </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üíª Labs &amp; Exercises</div>
                <div class="gallery-grid"><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="5.1.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Successful imports + package versions (GeoPandas, matplotlib, mapclassify; cartogram if used)</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox" checked="checked"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper">
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [1]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd
<span class="token keyword">import</span> rasterio
<span class="token keyword">from</span> rasterio<span class="token punctuation">.</span>mask <span class="token keyword">import</span> mask

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [2]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string">"data/raw"</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [3]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

study <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span><span class="token string">"data/raw/study_area.shp"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>study<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>
study<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Mecklenburg County Study Boundary"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [4]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> rasterio
<span class="token keyword">from</span> rasterio<span class="token punctuation">.</span>warp <span class="token keyword">import</span> calculate_default_transform<span class="token punctuation">,</span> reproject<span class="token punctuation">,</span> Resampling

<span class="token keyword">def</span> <span class="token function">reproject_raster</span><span class="token punctuation">(</span>input_raster<span class="token punctuation">,</span> output_raster<span class="token punctuation">,</span> target_crs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>input_raster<span class="token punctuation">)</span> <span class="token keyword">as</span> src<span class="token punctuation">:</span>
        transform<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height <span class="token operator">=</span> calculate_default_transform<span class="token punctuation">(</span>
            src<span class="token punctuation">.</span>crs<span class="token punctuation">,</span> target_crs<span class="token punctuation">,</span> src<span class="token punctuation">.</span>width<span class="token punctuation">,</span> src<span class="token punctuation">.</span>height<span class="token punctuation">,</span> <span class="token operator">*</span>src<span class="token punctuation">.</span>bounds<span class="token punctuation">)</span>
        kwargs <span class="token operator">=</span> src<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
        kwargs<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">'crs'</span><span class="token punctuation">:</span> target_crs<span class="token punctuation">,</span>
            <span class="token string">'transform'</span><span class="token punctuation">:</span> transform<span class="token punctuation">,</span>
            <span class="token string">'width'</span><span class="token punctuation">:</span> width<span class="token punctuation">,</span>
            <span class="token string">'height'</span><span class="token punctuation">:</span> height
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>output_raster<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span> <span class="token keyword">as</span> dst<span class="token punctuation">:</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> src<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                reproject<span class="token punctuation">(</span>
                    source<span class="token operator">=</span>rasterio<span class="token punctuation">.</span>band<span class="token punctuation">(</span>src<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    destination<span class="token operator">=</span>rasterio<span class="token punctuation">.</span>band<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    src_transform<span class="token operator">=</span>src<span class="token punctuation">.</span>transform<span class="token punctuation">,</span>
                    src_crs<span class="token operator">=</span>src<span class="token punctuation">.</span>crs<span class="token punctuation">,</span>
                    dst_transform<span class="token operator">=</span>transform<span class="token punctuation">,</span>
                    dst_crs<span class="token operator">=</span>target_crs<span class="token punctuation">,</span>
                    resampling<span class="token operator">=</span>Resampling<span class="token punctuation">.</span>nearest
                <span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Reprojected:"</span><span class="token punctuation">,</span> output_raster<span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [5]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">target_crs <span class="token operator">=</span> <span class="token string">"EPSG:2264"</span>

reproject_raster<span class="token punctuation">(</span><span class="token string">"data/raw/Mecklenburg_LST_June2025.tif"</span><span class="token punctuation">,</span>
                 <span class="token string">"data/processed/LST_reproj.tif"</span><span class="token punctuation">,</span>
                 target_crs<span class="token punctuation">)</span>

reproject_raster<span class="token punctuation">(</span><span class="token string">"data/raw/Mecklenburg_NDVI_June2025.tif"</span><span class="token punctuation">,</span>
                 <span class="token string">"data/processed/NDVI_reproj.tif"</span><span class="token punctuation">,</span>
                 target_crs<span class="token punctuation">)</span>

reproject_raster<span class="token punctuation">(</span><span class="token string">"data/raw/Mecklenburg_Albedo_June2025.tif"</span><span class="token punctuation">,</span>
                 <span class="token string">"data/processed/Albedo_reproj.tif"</span><span class="token punctuation">,</span>
                 target_crs<span class="token punctuation">)</span>

reproject_raster<span class="token punctuation">(</span><span class="token string">"data/raw/NLCD_TreeCanopy.tif"</span><span class="token punctuation">,</span>
                 <span class="token string">"data/processed/TreeCanopy_reproj.tif"</span><span class="token punctuation">,</span>
                 target_crs<span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [6]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">from</span> rasterio<span class="token punctuation">.</span>mask <span class="token keyword">import</span> mask

<span class="token keyword">def</span> <span class="token function">mask_raster</span><span class="token punctuation">(</span>input_raster<span class="token punctuation">,</span> boundary<span class="token punctuation">,</span> output_raster<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>input_raster<span class="token punctuation">)</span> <span class="token keyword">as</span> src<span class="token punctuation">:</span>
        boundary <span class="token operator">=</span> boundary<span class="token punctuation">.</span>to_crs<span class="token punctuation">(</span>src<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>
        geom <span class="token operator">=</span> boundary<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>values
        masked<span class="token punctuation">,</span> transform <span class="token operator">=</span> mask<span class="token punctuation">(</span>src<span class="token punctuation">,</span> geom<span class="token punctuation">,</span> crop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

        meta <span class="token operator">=</span> src<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
        meta<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">"height"</span><span class="token punctuation">:</span> masked<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"width"</span><span class="token punctuation">:</span> masked<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"transform"</span><span class="token punctuation">:</span> transform
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>output_raster<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> <span class="token operator">**</span>meta<span class="token punctuation">)</span> <span class="token keyword">as</span> dst<span class="token punctuation">:</span>
            dst<span class="token punctuation">.</span>write<span class="token punctuation">(</span>masked<span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Masked:"</span><span class="token punctuation">,</span> output_raster<span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [7]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">mask_raster<span class="token punctuation">(</span><span class="token string">"data/processed/LST_reproj.tif"</span><span class="token punctuation">,</span> study<span class="token punctuation">,</span> <span class="token string">"data/processed/LST_masked.tif"</span><span class="token punctuation">)</span>
mask_raster<span class="token punctuation">(</span><span class="token string">"data/processed/NDVI_reproj.tif"</span><span class="token punctuation">,</span> study<span class="token punctuation">,</span> <span class="token string">"data/processed/NDVI_masked.tif"</span><span class="token punctuation">)</span>
mask_raster<span class="token punctuation">(</span><span class="token string">"data/processed/Albedo_reproj.tif"</span><span class="token punctuation">,</span> study<span class="token punctuation">,</span> <span class="token string">"data/processed/Albedo_masked.tif"</span><span class="token punctuation">)</span>
mask_raster<span class="token punctuation">(</span><span class="token string">"data/processed/TreeCanopy_reproj.tif"</span><span class="token punctuation">,</span> study<span class="token punctuation">,</span> <span class="token string">"data/processed/TreeCanopy_masked.tif"</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [8]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> rasterio
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [9]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">def</span> <span class="token function">plot_raster</span><span class="token punctuation">(</span>raster_path<span class="token punctuation">,</span> title<span class="token punctuation">,</span> output_png<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'viridis'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Plot a raster, handle NoData, and save as PNG.

    Parameters:
    - raster_path: str, path to raster file
    - title: str, title of the plot and colorbar label
    - output_png: str, filename to save in outputs/
    - cmap: str, matplotlib colormap
    """</span>
    <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>raster_path<span class="token punctuation">)</span> <span class="token keyword">as</span> src<span class="token punctuation">:</span>
        band <span class="token operator">=</span> src<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        nodata <span class="token operator">=</span> src<span class="token punctuation">.</span>nodata
        data <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>band <span class="token operator">==</span> nodata<span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> band<span class="token punctuation">)</span>

    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>data<span class="token punctuation">,</span> cmap<span class="token operator">=</span>cmap<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span>label<span class="token operator">=</span>title<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>title<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>

    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"outputs/</span><span class="token interpolation"><span class="token punctuation">{</span>output_png<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Exported:"</span><span class="token punctuation">,</span> output_png<span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [10]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># Land Surface Temperature</span>
plot_raster<span class="token punctuation">(</span><span class="token string">"data/processed/LST_masked.tif"</span><span class="token punctuation">,</span>
            <span class="token string">"Land Surface Temperature (¬∞C) ‚Äî June 2025"</span><span class="token punctuation">,</span>
            <span class="token string">"Fig1_LST_Map.png"</span><span class="token punctuation">,</span>
            cmap<span class="token operator">=</span><span class="token string">'coolwarm'</span><span class="token punctuation">)</span>

<span class="token comment"># NDVI</span>
plot_raster<span class="token punctuation">(</span><span class="token string">"data/processed/NDVI_masked.tif"</span><span class="token punctuation">,</span>
            <span class="token string">"Vegetation Density (NDVI) ‚Äî June 2025"</span><span class="token punctuation">,</span>
            <span class="token string">"Fig2_NDVI_Map.png"</span><span class="token punctuation">,</span>
            cmap<span class="token operator">=</span><span class="token string">'Greens'</span><span class="token punctuation">)</span>

<span class="token comment"># Albedo</span>
plot_raster<span class="token punctuation">(</span><span class="token string">"data/processed/Albedo_masked.tif"</span><span class="token punctuation">,</span>
            <span class="token string">"Albedo (%) ‚Äî June 2025"</span><span class="token punctuation">,</span>
            <span class="token string">"Fig3_Albedo_Map.png"</span><span class="token punctuation">,</span>
            cmap<span class="token operator">=</span><span class="token string">'YlGnBu'</span><span class="token punctuation">)</span>

<span class="token comment"># Tree Canopy</span>
plot_raster<span class="token punctuation">(</span><span class="token string">"data/processed/TreeCanopy_masked.tif"</span><span class="token punctuation">,</span>
            <span class="token string">"Tree Canopy Cover (%) ‚Äî NLCD"</span><span class="token punctuation">,</span>
            <span class="token string">"Fig4_TreeCanopy_Map.png"</span><span class="token punctuation">,</span>
            cmap<span class="token operator">=</span><span class="token string">'Greens'</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [11]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">def</span> <span class="token function">plot_raster_with_water</span><span class="token punctuation">(</span>raster_path<span class="token punctuation">,</span> water_gdf<span class="token punctuation">,</span> title<span class="token punctuation">,</span> output_png<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">'coolwarm'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Open raster</span>
    <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>raster_path<span class="token punctuation">)</span> <span class="token keyword">as</span> src<span class="token punctuation">:</span>
        band <span class="token operator">=</span> src<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        nodata <span class="token operator">=</span> src<span class="token punctuation">.</span>nodata
        data <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>band <span class="token operator">==</span> nodata<span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> band<span class="token punctuation">)</span>
        extent <span class="token operator">=</span> <span class="token punctuation">[</span>src<span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>left<span class="token punctuation">,</span> src<span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>right<span class="token punctuation">,</span> src<span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>bottom<span class="token punctuation">,</span> src<span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>top<span class="token punctuation">]</span>

    <span class="token comment"># Plot raster</span>
    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>data<span class="token punctuation">,</span> extent<span class="token operator">=</span>extent<span class="token punctuation">,</span> cmap<span class="token operator">=</span>cmap<span class="token punctuation">,</span> origin<span class="token string">'upper'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span>label<span class="token operator">=</span>title<span class="token punctuation">)</span>
    
    <span class="token comment"># Overlay water</span>
    water_gdf<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ax<span class="token operator">=</span>plt<span class="token punctuation">.</span>gca<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'darkblue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>title<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"outputs/</span><span class="token interpolation"><span class="token punctuation">{</span>output_png<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Exported:"</span><span class="token punctuation">,</span> output_png<span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [12]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token comment"># Load ponds shapefile</span>
ponds <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span><span class="token string">"data/raw/ponds.shp"</span><span class="token punctuation">)</span>

<span class="token comment"># Optional: check CRS</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Ponds CRS:"</span><span class="token punctuation">,</span> ponds<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>

<span class="token comment"># Load ponds shapefile</span>
ponds <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>raw_folder<span class="token punctuation">,</span> <span class="token string">"ponds.shp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Reproject to study CRS</span>
ponds <span class="token operator">=</span> ponds<span class="token punctuation">.</span>to_crs<span class="token punctuation">(</span>study<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>

<span class="token comment"># Clip to study boundary</span>
ponds_clip <span class="token operator">=</span> gpd<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>ponds<span class="token punctuation">,</span> study<span class="token punctuation">)</span>

<span class="token comment"># Plot standalone ponds map</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ponds_clip<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>facecolor<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'darkblue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Ponds / Water Bodies ‚Äî Mecklenburg County"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Export clipped ponds</span>
ponds_clip<span class="token punctuation">.</span>to_file<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>processed_folder<span class="token punctuation">,</span> <span class="token string">"ponds_clip.gpkg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> driver<span class="token operator">=</span><span class="token string">"GPKG"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Saved ponds_clip.gpkg"</span><span class="token punctuation">)</span>

<span class="token comment"># Save figure</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">"outputs/Fig7_Ponds_Map.png"</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Exported: Fig7_Ponds_Map.png"</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [13]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> rasterio
<span class="token keyword">from</span> rasterio<span class="token punctuation">.</span>warp <span class="token keyword">import</span> calculate_default_transform<span class="token punctuation">,</span> reproject<span class="token punctuation">,</span> Resampling

<span class="token keyword">def</span> <span class="token function">reproject_raster</span><span class="token punctuation">(</span>input_fp<span class="token punctuation">,</span> output_fp<span class="token punctuation">,</span> target_crs<span class="token operator">=</span><span class="token string">"EPSG:2264"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Reproject raster to target CRS."""</span>
    <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>input_fp<span class="token punctuation">)</span> <span class="token keyword">as</span> src<span class="token punctuation">:</span>
        transform<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height <span class="token operator">=</span> calculate_default_transform<span class="token punctuation">(</span>
            src<span class="token punctuation">.</span>crs<span class="token punctuation">,</span> target_crs<span class="token punctuation">,</span> src<span class="token punctuation">.</span>width<span class="token punctuation">,</span> src<span class="token punctuation">.</span>height<span class="token punctuation">,</span> <span class="token operator">*</span>src<span class="token punctuation">.</span>bounds
        <span class="token punctuation">)</span>
        kwargs <span class="token operator">=</span> src<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
        kwargs<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">"crs"</span><span class="token punctuation">:</span> target_crs<span class="token punctuation">,</span>
            <span class="token string">"transform"</span><span class="token punctuation">:</span> transform<span class="token punctuation">,</span>
            <span class="token string">"width"</span><span class="token punctuation">:</span> width<span class="token punctuation">,</span>
            <span class="token string">"height"</span><span class="token punctuation">:</span> height
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>output_fp<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span> <span class="token keyword">as</span> dst<span class="token punctuation">:</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> src<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                reproject<span class="token punctuation">(</span>
                    source<span class="token operator">=</span>rasterio<span class="token punctuation">.</span>band<span class="token punctuation">(</span>src<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    destination<span class="token operator">=</span>rasterio<span class="token punctuation">.</span>band<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span>
                    src_transform<span class="token operator">=</span>src<span class="token punctuation">.</span>transform<span class="token punctuation">,</span>
                    src_crs<span class="token operator">=</span>src<span class="token punctuation">.</span>crs<span class="token punctuation">,</span>
                    dst_transform<span class="token operator">=</span>transform<span class="token punctuation">,</span>
                    dst_crs<span class="token operator">=</span>target_crs<span class="token punctuation">,</span>
                    resampling<span class="token operator">=</span>Resampling<span class="token punctuation">.</span>nearest
                <span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Reprojected and saved:"</span><span class="token punctuation">,</span> output_fp<span class="token punctuation">)</span>


<span class="token comment"># Example usage</span>
reproject_raster<span class="token punctuation">(</span><span class="token string">"data/raw/Mecklenburg_LST_June2025.tif"</span><span class="token punctuation">,</span>
                 <span class="token string">"data/processed/LST_reproj.tif"</span><span class="token punctuation">)</span>

reproject_raster<span class="token punctuation">(</span><span class="token string">"data/raw/Mecklenburg_NDVI_June2025.tif"</span><span class="token punctuation">,</span>
                 <span class="token string">"data/processed/NDVI_reproj.tif"</span><span class="token punctuation">)</span>

reproject_raster<span class="token punctuation">(</span><span class="token string">"data/raw/Mecklenburg_Albedo_June2025.tif"</span><span class="token punctuation">,</span>
                 <span class="token string">"data/processed/Albedo_reproj.tif"</span><span class="token punctuation">)</span>

reproject_raster<span class="token punctuation">(</span><span class="token string">"data/raw/NLCD_TreeCanopy.tif"</span><span class="token punctuation">,</span>
                 <span class="token string">"data/processed/TreeCanopy_reproj.tif"</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [14]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> rasterio
<span class="token keyword">from</span> rasterio<span class="token punctuation">.</span>mask <span class="token keyword">import</span> mask
<span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> os

<span class="token comment"># --------------------------</span>
<span class="token comment"># File paths</span>
<span class="token comment"># --------------------------</span>
study_fp <span class="token operator">=</span> <span class="token string">"data/raw/study_area.shp"</span>  <span class="token comment"># Your study boundary shapefile</span>
lst_fp <span class="token operator">=</span> <span class="token string">"data/raw/Mecklenburg_LST_June2025.tif"</span>
ndvi_fp <span class="token operator">=</span> <span class="token string">"data/raw/Mecklenburg_NDVI_June2025.tif"</span>
albedo_fp <span class="token operator">=</span> <span class="token string">"data/raw/Mecklenburg_Albedo_June2025.tif"</span>

lst_out <span class="token operator">=</span> <span class="token string">"data/processed/LST_clipped.tif"</span>
ndvi_out <span class="token operator">=</span> <span class="token string">"data/processed/NDVI_clipped.tif"</span>
albedo_out <span class="token operator">=</span> <span class="token string">"data/processed/Albedo_clipped.tif"</span>

<span class="token comment"># Ensure output folder exists</span>
os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token string">"data/processed"</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># --------------------------</span>
<span class="token comment"># Load study area</span>
<span class="token comment"># --------------------------</span>
study <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span>study_fp<span class="token punctuation">)</span>

<span class="token comment"># --------------------------</span>
<span class="token comment"># Generic clip + clean function</span>
<span class="token comment"># --------------------------</span>
<span class="token keyword">def</span> <span class="token function">clip_raster</span><span class="token punctuation">(</span>raster_path<span class="token punctuation">,</span> vector_gdf<span class="token punctuation">,</span> output_path<span class="token punctuation">,</span> manual_nodata<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Clips a raster to a vector geometry and replaces nodata values with NaN.
    """</span>
    <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>raster_path<span class="token punctuation">)</span> <span class="token keyword">as</span> src<span class="token punctuation">:</span>
        <span class="token comment"># Reproject vector to raster CRS</span>
        vector_gdf <span class="token operator">=</span> vector_gdf<span class="token punctuation">.</span>to_crs<span class="token punctuation">(</span>src<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>
        geom <span class="token operator">=</span> vector_gdf<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>values
        
        <span class="token comment"># Clip raster</span>
        clipped<span class="token punctuation">,</span> transform <span class="token operator">=</span> mask<span class="token punctuation">(</span>src<span class="token punctuation">,</span> geom<span class="token punctuation">,</span> crop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        
        <span class="token comment"># Handle nodata</span>
        nodata <span class="token operator">=</span> src<span class="token punctuation">.</span>nodata <span class="token keyword">if</span> src<span class="token punctuation">.</span>nodata <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">else</span> manual_nodata
        <span class="token keyword">if</span> nodata <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            clipped <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>clipped <span class="token operator">==</span> nodata<span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> clipped<span class="token punctuation">)</span>
        
        <span class="token comment"># Update metadata</span>
        out_meta <span class="token operator">=</span> src<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
        out_meta<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">"driver"</span><span class="token punctuation">:</span> <span class="token string">"GTiff"</span><span class="token punctuation">,</span>
            <span class="token string">"height"</span><span class="token punctuation">:</span> clipped<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"width"</span><span class="token punctuation">:</span> clipped<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"transform"</span><span class="token punctuation">:</span> transform<span class="token punctuation">,</span>
            <span class="token string">"nodata"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>nan
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token comment"># Save clipped raster</span>
        <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>output_path<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> <span class="token operator">**</span>out_meta<span class="token punctuation">)</span> <span class="token keyword">as</span> dst<span class="token punctuation">:</span>
            dst<span class="token punctuation">.</span>write<span class="token punctuation">(</span>clipped<span class="token punctuation">)</span>
        
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Raster clipped and saved: </span><span class="token interpolation"><span class="token punctuation">{</span>output_path<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

<span class="token comment"># --------------------------</span>
<span class="token comment"># Clip all rasters</span>
<span class="token comment"># --------------------------</span>
clip_raster<span class="token punctuation">(</span>lst_fp<span class="token punctuation">,</span> study<span class="token punctuation">,</span> lst_out<span class="token punctuation">,</span> manual_nodata<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
clip_raster<span class="token punctuation">(</span>ndvi_fp<span class="token punctuation">,</span> study<span class="token punctuation">,</span> ndvi_out<span class="token punctuation">,</span> manual_nodata<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
clip_raster<span class="token punctuation">(</span>albedo_fp<span class="token punctuation">,</span> study<span class="token punctuation">,</span> albedo_out<span class="token punctuation">,</span> manual_nodata<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [15]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> rasterio
<span class="token keyword">from</span> rasterio<span class="token punctuation">.</span>mask <span class="token keyword">import</span> mask
<span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> os
<span class="token keyword">from</span> rasterio<span class="token punctuation">.</span>warp <span class="token keyword">import</span> calculate_default_transform<span class="token punctuation">,</span> reproject<span class="token punctuation">,</span> Resampling

<span class="token comment"># --------------------------</span>
<span class="token comment"># Reproject raster function</span>
<span class="token comment"># --------------------------</span>
<span class="token keyword">def</span> <span class="token function">reproject_raster</span><span class="token punctuation">(</span>input_fp<span class="token punctuation">,</span> output_fp<span class="token punctuation">,</span> target_crs<span class="token operator">=</span><span class="token string">"EPSG:2264"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Reproject raster to target CRS."""</span>
    <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>input_fp<span class="token punctuation">)</span> <span class="token keyword">as</span> src<span class="token punctuation">:</span>
        transform<span class="token punctuation">,</span> width<span class="token punctuation">,</span> height <span class="token operator">=</span> calculate_default_transform<span class="token punctuation">(</span>
            src<span class="token punctuation">.</span>crs<span class="token punctuation">,</span> target_crs<span class="token punctuation">,</span> src<span class="token punctuation">.</span>width<span class="token punctuation">,</span> src<span class="token punctuation">.</span>height<span class="token punctuation">,</span> <span class="token operator">*</span>src<span class="token punctuation">.</span>bounds
        <span class="token punctuation">)</span>
        kwargs <span class="token operator">=</span> src<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
        kwargs<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">'crs'</span><span class="token punctuation">:</span> target_crs<span class="token punctuation">,</span>
            <span class="token string">'transform'</span><span class="token punctuation">:</span> transform<span class="token punctuation">,</span>
            <span class="token string">'width'</span><span class="token punctuation">:</span> width<span class="token punctuation">,</span>
            <span class="token string">'height'</span><span class="token punctuation">:</span> height
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        reprojected <span class="token operator">=</span> np<span class="token punctuation">.</span>empty<span class="token punctuation">(</span><span class="token punctuation">(</span>src<span class="token punctuation">.</span>count<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>src<span class="token punctuation">.</span>meta<span class="token punctuation">[</span><span class="token string">'dtype'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> src<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            reproject<span class="token punctuation">(</span>
                source<span class="token operator">=</span>rasterio<span class="token punctuation">.</span>band<span class="token punctuation">(</span>src<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span>
                destination<span class="token operator">=</span>reprojected<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                src_transform<span class="token operator">=</span>src<span class="token punctuation">.</span>transform<span class="token punctuation">,</span>
                src_crs<span class="token operator">=</span>src<span class="token punctuation">.</span>crs<span class="token punctuation">,</span>
                dst_transform<span class="token operator">=</span>transform<span class="token punctuation">,</span>
                dst_crs<span class="token operator">=</span>target_crs<span class="token punctuation">,</span>
                resampling<span class="token operator">=</span>Resampling<span class="token punctuation">.</span>nearest
            <span class="token punctuation">)</span>

        <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>output_fp<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span> <span class="token keyword">as</span> dst<span class="token punctuation">:</span>
            dst<span class="token punctuation">.</span>write<span class="token punctuation">(</span>reprojected<span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Raster reprojected and saved: </span><span class="token interpolation"><span class="token punctuation">{</span>output_fp<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>


<span class="token comment"># --------------------------</span>
<span class="token comment"># File paths</span>
<span class="token comment"># --------------------------</span>
study_fp <span class="token operator">=</span> <span class="token string">"data/raw/study_area.shp"</span>  <span class="token comment"># Your study boundary shapefile</span>
lst_fp <span class="token operator">=</span> <span class="token string">"data/raw/Mecklenburg_LST_June2025.tif"</span>
ndvi_fp <span class="token operator">=</span> <span class="token string">"data/raw/Mecklenburg_NDVI_June2025.tif"</span>
albedo_fp <span class="token operator">=</span> <span class="token string">"data/raw/Mecklenburg_Albedo_June2025.tif"</span>

lst_out <span class="token operator">=</span> <span class="token string">"data/processed/LST_clipped.tif"</span>
ndvi_out <span class="token operator">=</span> <span class="token string">"data/processed/NDVI_clipped.tif"</span>
albedo_out <span class="token operator">=</span> <span class="token string">"data/processed/Albedo_clipped.tif"</span>

<span class="token comment"># Ensure output folder exists</span>
os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token string">"data/processed"</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># --------------------------</span>
<span class="token comment"># Load study area</span>
<span class="token comment"># --------------------------</span>
study <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span>study_fp<span class="token punctuation">)</span>

<span class="token comment"># --------------------------</span>
<span class="token comment"># Generic clip + clean function</span>
<span class="token comment"># --------------------------</span>
<span class="token keyword">def</span> <span class="token function">clip_raster</span><span class="token punctuation">(</span>raster_path<span class="token punctuation">,</span> vector_gdf<span class="token punctuation">,</span> output_path<span class="token punctuation">,</span> manual_nodata<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Clips a raster to a vector geometry and replaces nodata values with NaN.
    """</span>
    <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>raster_path<span class="token punctuation">)</span> <span class="token keyword">as</span> src<span class="token punctuation">:</span>
        <span class="token comment"># Reproject vector to raster CRS</span>
        vector_gdf <span class="token operator">=</span> vector_gdf<span class="token punctuation">.</span>to_crs<span class="token punctuation">(</span>src<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>
        geom <span class="token operator">=</span> vector_gdf<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>values
        
        <span class="token comment"># Clip raster</span>
        clipped<span class="token punctuation">,</span> transform <span class="token operator">=</span> mask<span class="token punctuation">(</span>src<span class="token punctuation">,</span> geom<span class="token punctuation">,</span> crop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        
        <span class="token comment"># Handle nodata</span>
        nodata <span class="token operator">=</span> src<span class="token punctuation">.</span>nodata <span class="token keyword">if</span> src<span class="token punctuation">.</span>nodata <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">else</span> manual_nodata
        <span class="token keyword">if</span> nodata <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
            clipped <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>clipped <span class="token operator">==</span> nodata<span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> clipped<span class="token punctuation">)</span>
        
        <span class="token comment"># Update metadata</span>
        out_meta <span class="token operator">=</span> src<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
        out_meta<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">"driver"</span><span class="token punctuation">:</span> <span class="token string">"GTiff"</span><span class="token punctuation">,</span>
            <span class="token string">"height"</span><span class="token punctuation">:</span> clipped<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"width"</span><span class="token punctuation">:</span> clipped<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token string">"transform"</span><span class="token punctuation">:</span> transform<span class="token punctuation">,</span>
            <span class="token string">"nodata"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>nan
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        
        <span class="token comment"># Save clipped raster</span>
        <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>output_path<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">,</span> <span class="token operator">**</span>out_meta<span class="token punctuation">)</span> <span class="token keyword">as</span> dst<span class="token punctuation">:</span>
            dst<span class="token punctuation">.</span>write<span class="token punctuation">(</span>clipped<span class="token punctuation">)</span>
        
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Raster clipped and saved: </span><span class="token interpolation"><span class="token punctuation">{</span>output_path<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>


<span class="token comment"># --------------------------</span>
<span class="token comment"># Example workflow</span>
<span class="token comment"># --------------------------</span>
<span class="token comment"># Optional: reproject first</span>
reproject_raster<span class="token punctuation">(</span>lst_fp<span class="token punctuation">,</span> <span class="token string">"data/processed/LST_reproj.tif"</span><span class="token punctuation">)</span>
reproject_raster<span class="token punctuation">(</span>ndvi_fp<span class="token punctuation">,</span> <span class="token string">"data/processed/NDVI_reproj.tif"</span><span class="token punctuation">)</span>
reproject_raster<span class="token punctuation">(</span>albedo_fp<span class="token punctuation">,</span> <span class="token string">"data/processed/Albedo_reproj.tif"</span><span class="token punctuation">)</span>

<span class="token comment"># Then clip to study area</span>
clip_raster<span class="token punctuation">(</span><span class="token string">"data/processed/LST_reproj.tif"</span><span class="token punctuation">,</span> study<span class="token punctuation">,</span> lst_out<span class="token punctuation">,</span> manual_nodata<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
clip_raster<span class="token punctuation">(</span><span class="token string">"data/processed/NDVI_reproj.tif"</span><span class="token punctuation">,</span> study<span class="token punctuation">,</span> ndvi_out<span class="token punctuation">,</span> manual_nodata<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
clip_raster<span class="token punctuation">(</span><span class="token string">"data/processed/Albedo_reproj.tif"</span><span class="token punctuation">,</span> study<span class="token punctuation">,</span> albedo_out<span class="token punctuation">,</span> manual_nodata<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [16]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">plot_raster<span class="token punctuation">(</span>lst_out<span class="token punctuation">,</span> <span class="token string">"Land Surface Temperature (¬∞C) ‚Äî June 2025"</span><span class="token punctuation">)</span>
plot_raster<span class="token punctuation">(</span>ndvi_out<span class="token punctuation">,</span> <span class="token string">"Vegetation Density (NDVI) ‚Äî June 2025"</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">"YlGn"</span><span class="token punctuation">)</span>
plot_raster<span class="token punctuation">(</span>albedo_out<span class="token punctuation">,</span> <span class="token string">"Albedo (%) ‚Äî June 2025"</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">"Greys"</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [17]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># Export LST, NDVI, Albedo as PNG</span>
plot_and_export_raster<span class="token punctuation">(</span><span class="token string">"data/processed/LST_clipped.tif"</span><span class="token punctuation">,</span> 
                       <span class="token string">"Land Surface Temperature (¬∞C) ‚Äî June 2025"</span><span class="token punctuation">,</span>
                       <span class="token string">"LST_clipped.png"</span><span class="token punctuation">)</span>

plot_and_export_raster<span class="token punctuation">(</span><span class="token string">"data/processed/NDVI_clipped.tif"</span><span class="token punctuation">,</span> 
                       <span class="token string">"Vegetation Density (NDVI) ‚Äî June 2025"</span><span class="token punctuation">,</span>
                       <span class="token string">"NDVI_clipped.png"</span><span class="token punctuation">,</span>
                       cmap<span class="token operator">=</span><span class="token string">"YlGn"</span><span class="token punctuation">)</span>

plot_and_export_raster<span class="token punctuation">(</span><span class="token string">"data/processed/Albedo_clipped.tif"</span><span class="token punctuation">,</span> 
                       <span class="token string">"Albedo (%) ‚Äî June 2025"</span><span class="token punctuation">,</span>
                       <span class="token string">"Albedo_clipped.png"</span><span class="token punctuation">,</span>
                       cmap<span class="token operator">=</span><span class="token string">"Greys"</span><span class="token punctuation">)</span></code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [18]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># Load ponds shapefile</span>
ponds <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>raw_folder<span class="token punctuation">,</span> <span class="token string">"ponds.shp"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Reproject to study CRS</span>
ponds <span class="token operator">=</span> ponds<span class="token punctuation">.</span>to_crs<span class="token punctuation">(</span>study<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>

<span class="token comment"># Clip to study boundary</span>
ponds_clip <span class="token operator">=</span> gpd<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>ponds<span class="token punctuation">,</span> study<span class="token punctuation">)</span>

<span class="token comment"># Plot standalone ponds map</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ponds_clip<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>facecolor<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'darkblue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Ponds / Water Bodies ‚Äî Mecklenburg County"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'off'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Export clipped ponds</span>
ponds_clip<span class="token punctuation">.</span>to_file<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>processed_folder<span class="token punctuation">,</span> <span class="token string">"ponds_clip.gpkg"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> driver<span class="token operator">=</span><span class="token string">"GPKG"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Saved ponds_clip.gpkg"</span><span class="token punctuation">)</span>

</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [19]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> rasterio
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

raster_fp <span class="token operator">=</span> <span class="token string">"data/processed/LST_clipped.tif"</span>

<span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>raster_fp<span class="token punctuation">)</span> <span class="token keyword">as</span> src<span class="token punctuation">:</span>
    lst <span class="token operator">=</span> src<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    raster_crs <span class="token operator">=</span> src<span class="token punctuation">.</span>crs
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Raster CRS:"</span><span class="token punctuation">,</span> raster_crs<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Raster shape:"</span><span class="token punctuation">,</span> lst<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

    nodata <span class="token operator">=</span> src<span class="token punctuation">.</span>nodata
    <span class="token keyword">if</span> nodata <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        lst <span class="token operator">=</span> np<span class="token punctuation">.</span>where<span class="token punctuation">(</span>lst <span class="token operator">==</span> nodata<span class="token punctuation">,</span> np<span class="token punctuation">.</span>nan<span class="token punctuation">,</span> lst<span class="token punctuation">)</span>

<span class="token comment"># Plot raster</span>
plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>lst<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">"viridis"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"LST (¬∞C)"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Raster: LST Clipped"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [20]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd

ponds_fp <span class="token operator">=</span> <span class="token string">"data/processed/ponds_clip.gpkg"</span>  <span class="token comment"># or .shp if you haven‚Äôt exported yet</span>
ponds <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span>ponds_fp<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Ponds CRS:"</span><span class="token punctuation">,</span> ponds<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Number of features:"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ponds<span class="token punctuation">)</span><span class="token punctuation">)</span>
ponds<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>facecolor<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'darkblue'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Vector: Ponds / Water Bodies"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [21]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Plot raster first</span>
plt<span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>lst<span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">"viridis"</span><span class="token punctuation">,</span> extent<span class="token operator">=</span><span class="token punctuation">[</span>src<span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>left<span class="token punctuation">,</span> src<span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>right<span class="token punctuation">,</span> src<span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>bottom<span class="token punctuation">,</span> src<span class="token punctuation">.</span>bounds<span class="token punctuation">.</span>top<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># Then plot ponds on top</span>
ponds<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>ax<span class="token operator">=</span>plt<span class="token punctuation">.</span>gca<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">"blue"</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"LST with Water Cooling Features Overlay"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">"outputs/Fig5_WaterCooling_Map.png"</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [22]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># STEP 6 ‚Äî Cooling Impact Analysis (Main Science)</span>

<span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd
<span class="token keyword">from</span> shapely<span class="token punctuation">.</span>geometry <span class="token keyword">import</span> Point
<span class="token keyword">import</span> random
<span class="token keyword">import</span> rasterio
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># 6.1 Sample Random Points within the Study Area</span>
N <span class="token operator">=</span> <span class="token number">300</span>  <span class="token comment"># Number of random points</span>

minx<span class="token punctuation">,</span> miny<span class="token punctuation">,</span> maxx<span class="token punctuation">,</span> maxy <span class="token operator">=</span> study<span class="token punctuation">.</span>total_bounds
pts <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pts<span class="token punctuation">)</span> <span class="token operator">&lt;</span> N<span class="token punctuation">:</span>
    x <span class="token operator">=</span> random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>minx<span class="token punctuation">,</span> maxx<span class="token punctuation">)</span>
    y <span class="token operator">=</span> random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span>miny<span class="token punctuation">,</span> maxy<span class="token punctuation">)</span>
    p <span class="token operator">=</span> Point<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
    <span class="token comment"># Only keep points inside the study boundary</span>
    <span class="token keyword">if</span> study<span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>union_all<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>
        pts<span class="token punctuation">.</span>append<span class="token punctuation">(</span>p<span class="token punctuation">)</span>

points <span class="token operator">=</span> gpd<span class="token punctuation">.</span>GeoDataFrame<span class="token punctuation">(</span>geometry<span class="token operator">=</span>pts<span class="token punctuation">,</span> crs<span class="token operator">=</span>study<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Sampled points:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>points<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment"># 6.2 Function to Extract Raster Values at Points</span>
<span class="token keyword">def</span> <span class="token function">sample_raster</span><span class="token punctuation">(</span>raster_path<span class="token punctuation">,</span> points<span class="token punctuation">,</span> nodata_value<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    Sample raster values at point locations.

    Parameters:
    - raster_path: str, path to raster file
    - points: GeoDataFrame of point geometries
    - nodata_value: optional, value to treat as no data
    """</span>
    <span class="token keyword">with</span> rasterio<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span>raster_path<span class="token punctuation">)</span> <span class="token keyword">as</span> src<span class="token punctuation">:</span>
        coords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>x<span class="token punctuation">,</span> p<span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token keyword">for</span> p <span class="token keyword">in</span> points<span class="token punctuation">.</span>geometry<span class="token punctuation">]</span>
        values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        raster_nodata <span class="token operator">=</span> nodata_value <span class="token keyword">if</span> nodata_value <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">else</span> src<span class="token punctuation">.</span>nodata

        <span class="token keyword">for</span> val <span class="token keyword">in</span> src<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>coords<span class="token punctuation">)</span><span class="token punctuation">:</span>
            v <span class="token operator">=</span> val<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token keyword">if</span> raster_nodata <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> v <span class="token operator">==</span> raster_nodata<span class="token punctuation">:</span>
                values<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>  <span class="token comment"># or np.nan if preferred</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                values<span class="token punctuation">.</span>append<span class="token punctuation">(</span>v<span class="token punctuation">)</span>
    <span class="token keyword">return</span> values


<span class="token comment"># 6.3 Extract Raster Values for Each Variable</span>
points<span class="token punctuation">[</span><span class="token string">"LST"</span><span class="token punctuation">]</span> <span class="token operator">=</span> sample_raster<span class="token punctuation">(</span><span class="token string">"data/processed/LST_clipped.tif"</span><span class="token punctuation">,</span> points<span class="token punctuation">)</span>
points<span class="token punctuation">[</span><span class="token string">"TreeCover"</span><span class="token punctuation">]</span> <span class="token operator">=</span> sample_raster<span class="token punctuation">(</span><span class="token string">"data/processed/TreeCanopy_clipped.tif"</span><span class="token punctuation">,</span> points<span class="token punctuation">)</span>
points<span class="token punctuation">[</span><span class="token string">"NDVI"</span><span class="token punctuation">]</span> <span class="token operator">=</span> sample_raster<span class="token punctuation">(</span><span class="token string">"data/processed/NDVI_clipped.tif"</span><span class="token punctuation">,</span> points<span class="token punctuation">)</span>
points<span class="token punctuation">[</span><span class="token string">"Albedo"</span><span class="token punctuation">]</span> <span class="token operator">=</span> sample_raster<span class="token punctuation">(</span><span class="token string">"data/processed/Albedo_clipped.tif"</span><span class="token punctuation">,</span> points<span class="token punctuation">)</span>

<span class="token comment"># 6.4 Export Sampled Points to CSV</span>
points<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">"outputs/sampled_points.csv"</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Saved outputs/sampled_points.csv"</span><span class="token punctuation">)</span>

points<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [23]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token comment"># STEP 7 ‚Äî Graph 1: Tree Canopy vs LST Cooling</span>

<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token comment"># Prepare data (drop None / NaN if any)</span>
plot_data <span class="token operator">=</span> points<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"TreeCover"</span><span class="token punctuation">,</span> <span class="token string">"LST"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

x <span class="token operator">=</span> plot_data<span class="token punctuation">[</span><span class="token string">"TreeCover"</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> plot_data<span class="token punctuation">[</span><span class="token string">"LST"</span><span class="token punctuation">]</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Scatter plot</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.6</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">'k'</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">"forestgreen"</span><span class="token punctuation">)</span>

<span class="token comment"># Optional: Add linear trendline</span>
m<span class="token punctuation">,</span> b <span class="token operator">=</span> np<span class="token punctuation">.</span>polyfit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> m<span class="token operator">*</span>x <span class="token operator">+</span> b<span class="token punctuation">,</span> color<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f'Trendline: y=</span><span class="token interpolation"><span class="token punctuation">{</span>m<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">x+</span><span class="token interpolation"><span class="token punctuation">{</span>b<span class="token punctuation">:</span><span class="token format-spec">.2f</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>

<span class="token comment"># Axis labels</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"Tree Canopy Cover (%)"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"Land Surface Temperature (¬∞C)"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">12</span><span class="token punctuation">)</span>

<span class="token comment"># Title</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Cooling Effect of Tree Canopy on LST ‚Äî Mecklenburg County"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">14</span><span class="token punctuation">)</span>

<span class="token comment"># Grid and legend</span>
plt<span class="token punctuation">.</span>grid<span class="token punctuation">(</span>alpha<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Tight layout and save</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">"outputs/Fig6_TreeCoolingScatter.png"</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [24]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">from</span> pygris <span class="token keyword">import</span> tracts
<span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [25]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">tracts_nc <span class="token operator">=</span> tracts<span class="token punctuation">(</span>
    state<span class="token operator">=</span><span class="token string">"NC"</span><span class="token punctuation">,</span>        <span class="token comment"># North Carolina</span>
    county<span class="token operator">=</span><span class="token string">"Mecklenburg"</span><span class="token punctuation">,</span>
    year<span class="token operator">=</span><span class="token number">2022</span>
<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Downloaded tracts:"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tracts_nc<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>tracts_nc<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [26]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">tracts_nc<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Census Tracts ‚Äî Mecklenburg County, NC"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [27]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">tracts_nc<span class="token punctuation">.</span>to_file<span class="token punctuation">(</span>
    <span class="token string">"../data/raw/Mecklenburg_Tracts.gpkg"</span><span class="token punctuation">,</span>
    layer<span class="token operator">=</span><span class="token string">"tracts"</span><span class="token punctuation">,</span>
    driver<span class="token operator">=</span><span class="token string">"GPKG"</span>
<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Saved: Mecklenburg_Tracts.gpkg"</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [28]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

study <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span><span class="token string">"../data/raw/study_area.shp"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Study CRS:"</span><span class="token punctuation">,</span> study<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>

study<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Mecklenburg County Boundary"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [29]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> fiona

fiona<span class="token punctuation">.</span>listlayers<span class="token punctuation">(</span><span class="token string">"../data/raw/Mecklenburg_Tracts.gpkg"</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [30]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd

tracts_gdf <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span>
    <span class="token string">"../data/raw/Mecklenburg_Tracts.gpkg"</span><span class="token punctuation">,</span>
    layer<span class="token operator">=</span><span class="token string">"tracts"</span>   <span class="token comment"># change if your layer name is different</span>
<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>tracts_gdf<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"CRS:"</span><span class="token punctuation">,</span> tracts_gdf<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>tracts_gdf<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [31]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">WORK_EPSG <span class="token operator">=</span> <span class="token string">"EPSG:5070"</span>

tracts_m <span class="token operator">=</span> tracts_gdf<span class="token punctuation">.</span>to_crs<span class="token punctuation">(</span>WORK_EPSG<span class="token punctuation">)</span>
study_m  <span class="token operator">=</span> study<span class="token punctuation">.</span>to_crs<span class="token punctuation">(</span>WORK_EPSG<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Reprojection successful!"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"New CRS:"</span><span class="token punctuation">,</span> tracts_m<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [32]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">tracts_clip <span class="token operator">=</span> gpd<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>tracts_m<span class="token punctuation">,</span> study_m<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Polygons after clipping:"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tracts_clip<span class="token punctuation">)</span><span class="token punctuation">)</span>

tracts_clip<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Tracts Clipped to Mecklenburg County"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [33]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

<span class="token keyword">import</span> matplotlib
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token keyword">import</span> mapclassify

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"geopandas:"</span><span class="token punctuation">,</span> gpd<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"pandas:"</span><span class="token punctuation">,</span> pd<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"numpy:"</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"matplotlib:"</span><span class="token punctuation">,</span> matplotlib<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"mapclassify:"</span><span class="token punctuation">,</span> mapclassify<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [34]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> fiona

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Layers in GeoPackage:"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>fiona<span class="token punctuation">.</span>listlayers<span class="token punctuation">(</span><span class="token string">"../data/raw/Mecklenburg_Tracts.gpkg"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [35]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">tracts_gdf <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span>
    <span class="token string">"../data/raw/Mecklenburg_Tracts.gpkg"</span><span class="token punctuation">,</span>
    layer<span class="token operator">=</span><span class="token string">"tracts"</span>   <span class="token comment"># change if layer name differs</span>
<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Tracts CRS:"</span><span class="token punctuation">,</span> tracts_gdf<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Columns:"</span><span class="token punctuation">,</span> tracts_gdf<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>

tracts_gdf<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Census Tracts (Raw)"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [36]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">study_gdf <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span><span class="token string">"../data/raw/study_area.shp"</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Study CRS:"</span><span class="token punctuation">,</span> study_gdf<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>

study_gdf<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Mecklenburg County Boundary"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [37]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">WORK_EPSG <span class="token operator">=</span> <span class="token string">"EPSG:5070"</span>

tracts_m <span class="token operator">=</span> tracts_gdf<span class="token punctuation">.</span>to_crs<span class="token punctuation">(</span>WORK_EPSG<span class="token punctuation">)</span>
study_m  <span class="token operator">=</span> study_gdf<span class="token punctuation">.</span>to_crs<span class="token punctuation">(</span>WORK_EPSG<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Working CRS:"</span><span class="token punctuation">,</span> tracts_m<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [38]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">tracts_clip <span class="token operator">=</span> gpd<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>tracts_m<span class="token punctuation">,</span> study_m<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Polygons after clipping:"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tracts_clip<span class="token punctuation">)</span><span class="token punctuation">)</span>

tracts_clip<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Tracts Clipped to Mecklenburg County"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [39]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">from</span> rasterstats <span class="token keyword">import</span> zonal_stats

rast_lst <span class="token operator">=</span> <span class="token string">"../data/processed/LST_clipped.tif"</span>

lst_stats <span class="token operator">=</span> zonal_stats<span class="token punctuation">(</span>
    tracts_clip<span class="token punctuation">,</span>
    rast_lst<span class="token punctuation">,</span>
    stats<span class="token operator">=</span><span class="token string">"mean"</span>
<span class="token punctuation">)</span>

tracts_clip<span class="token punctuation">[</span><span class="token string">"LST_mean"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>s<span class="token punctuation">[</span><span class="token string">"mean"</span><span class="token punctuation">]</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> lst_stats<span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"LST added successfully!"</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [40]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">rast_ndvi <span class="token operator">=</span> <span class="token string">"../data/processed/NDVI_clipped.tif"</span>
rast_tree <span class="token operator">=</span> <span class="token string">"../data/processed/TreeCanopy_clipped.tif"</span>

ndvi_stats <span class="token operator">=</span> zonal_stats<span class="token punctuation">(</span>tracts_clip<span class="token punctuation">,</span> rast_ndvi<span class="token punctuation">,</span> stats<span class="token operator">=</span><span class="token string">"mean"</span><span class="token punctuation">)</span>
tracts_clip<span class="token punctuation">[</span><span class="token string">"NDVI_mean"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>s<span class="token punctuation">[</span><span class="token string">"mean"</span><span class="token punctuation">]</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> ndvi_stats<span class="token punctuation">]</span>

tree_stats <span class="token operator">=</span> zonal_stats<span class="token punctuation">(</span>tracts_clip<span class="token punctuation">,</span> rast_tree<span class="token punctuation">,</span> stats<span class="token operator">=</span><span class="token string">"mean"</span><span class="token punctuation">)</span>
tracts_clip<span class="token punctuation">[</span><span class="token string">"Tree_mean"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>s<span class="token punctuation">[</span><span class="token string">"mean"</span><span class="token punctuation">]</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> tree_stats<span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"NDVI + Tree Cover added!"</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [41]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">WORK_EPSG <span class="token operator">=</span> <span class="token string">"EPSG:2264"</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [42]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>tracts<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [43]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> geopandas <span class="token keyword">as</span> gpd
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> rasterstats <span class="token keyword">import</span> zonal_stats</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [44]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">tracts_gdf <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span><span class="token string">"../data/raw/Mecklenburg_Tracts.gpkg"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Tracts CRS:"</span><span class="token punctuation">,</span> tracts_gdf<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Columns:"</span><span class="token punctuation">,</span> tracts_gdf<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
tracts_gdf<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Census Tracts"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [45]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">study_gdf <span class="token operator">=</span> gpd<span class="token punctuation">.</span>read_file<span class="token punctuation">(</span><span class="token string">"../data/raw/study_area.shp"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Study CRS:"</span><span class="token punctuation">,</span> study_gdf<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>
study_gdf<span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Mecklenburg County Boundary"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [46]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">WORK_EPSG <span class="token operator">=</span> <span class="token string">"EPSG:2264"</span></code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [47]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">tracts_m <span class="token operator">=</span> tracts_gdf<span class="token punctuation">.</span>to_crs<span class="token punctuation">(</span>WORK_EPSG<span class="token punctuation">)</span>
study_m  <span class="token operator">=</span> study_gdf<span class="token punctuation">.</span>to_crs<span class="token punctuation">(</span>WORK_EPSG<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Reprojected Tracts CRS:"</span><span class="token punctuation">,</span> tracts_m<span class="token punctuation">.</span>crs<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Reprojected Study CRS:"</span><span class="token punctuation">,</span> study_m<span class="token punctuation">.</span>crs<span class="token punctuation">)</span></code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [48]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">tracts_clip <span class="token operator">=</span> gpd<span class="token punctuation">.</span>clip<span class="token punctuation">(</span>tracts_m<span class="token punctuation">,</span> study_m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Number of tracts after clipping:"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>tracts_clip<span class="token punctuation">)</span><span class="token punctuation">)</span>
tracts_clip<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Tracts Clipped to Mecklenburg County"</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [49]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">rast_lst <span class="token operator">=</span> <span class="token string">"../data/processed/LST_clipped.tif"</span>
lst_stats <span class="token operator">=</span> zonal_stats<span class="token punctuation">(</span>tracts_clip<span class="token punctuation">,</span> rast_lst<span class="token punctuation">,</span> stats<span class="token operator">=</span><span class="token string">"mean"</span><span class="token punctuation">)</span>
tracts_clip<span class="token punctuation">[</span><span class="token string">"LST_mean"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>s<span class="token punctuation">[</span><span class="token string">"mean"</span><span class="token punctuation">]</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> lst_stats<span class="token punctuation">]</span></code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [50]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">rast_ndvi <span class="token operator">=</span> <span class="token string">"../data/processed/NDVI_clipped.tif"</span>
ndvi_stats <span class="token operator">=</span> zonal_stats<span class="token punctuation">(</span>tracts_clip<span class="token punctuation">,</span> rast_ndvi<span class="token punctuation">,</span> stats<span class="token operator">=</span><span class="token string">"mean"</span><span class="token punctuation">)</span>
tracts_clip<span class="token punctuation">[</span><span class="token string">"NDVI_mean"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>s<span class="token punctuation">[</span><span class="token string">"mean"</span><span class="token punctuation">]</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> ndvi_stats<span class="token punctuation">]</span></code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [51]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">rast_tree <span class="token operator">=</span> <span class="token string">"../data/processed/TreeCanopy_clipped.tif"</span>
tree_stats <span class="token operator">=</span> zonal_stats<span class="token punctuation">(</span>tracts_clip<span class="token punctuation">,</span> rast_tree<span class="token punctuation">,</span> stats<span class="token operator">=</span><span class="token string">"mean"</span><span class="token punctuation">)</span>
tracts_clip<span class="token punctuation">[</span><span class="token string">"Tree_mean"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>s<span class="token punctuation">[</span><span class="token string">"mean"</span><span class="token punctuation">]</span> <span class="token keyword">for</span> s <span class="token keyword">in</span> tree_stats<span class="token punctuation">]</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [52]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">
<span class="token keyword">print</span><span class="token punctuation">(</span>tracts_clip<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"LST_mean"</span><span class="token punctuation">,</span> <span class="token string">"NDVI_mean"</span><span class="token punctuation">,</span> <span class="token string">"Tree_mean"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [53]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">VAR <span class="token operator">=</span> <span class="token string">"LST_mean"</span>

ax <span class="token operator">=</span> tracts_clip<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>
    column<span class="token operator">=</span>VAR<span class="token punctuation">,</span>
    scheme<span class="token operator">=</span><span class="token string">"Quantiles"</span><span class="token punctuation">,</span>
    k<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>
    cmap<span class="token operator">=</span><span class="token string">"Reds"</span><span class="token punctuation">,</span>
    linewidth<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>
    edgecolor<span class="token operator">=</span><span class="token string">"white"</span><span class="token punctuation">,</span>
    legend<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Choropleth: Mean Land Surface Temperature (LST)"</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_axis_off<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [54]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>patches <span class="token keyword">import</span> Rectangle

<span class="token comment"># Create the main figure</span>
fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Main map axis</span>
ax_map <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_axes<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># [left, bottom, width, height]</span>
tracts_clip<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>
    color<span class="token operator">=</span>tracts_clip<span class="token punctuation">[</span><span class="token string">"bi_color"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    linewidth<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>
    edgecolor<span class="token operator">=</span><span class="token string">"white"</span><span class="token punctuation">,</span>
    ax<span class="token operator">=</span>ax_map
<span class="token punctuation">)</span>
ax_map<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Bivariate Map: Tree Canopy (X) vs LST (Y)"</span><span class="token punctuation">)</span>
ax_map<span class="token punctuation">.</span>set_axis_off<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Legend axis</span>
ax_legend <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_axes<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.78</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.18</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># smaller axis for legend</span>

<span class="token comment"># Draw 3x3 legend</span>
N <span class="token operator">=</span> <span class="token number">3</span>
<span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
        idx <span class="token operator">=</span> y <span class="token operator">*</span> N <span class="token operator">+</span> x
        ax_legend<span class="token punctuation">.</span>add_patch<span class="token punctuation">(</span>Rectangle<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span>palette<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

ax_legend<span class="token punctuation">.</span>set_xlim<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_aspect<span class="token punctuation">(</span><span class="token string">"equal"</span><span class="token punctuation">)</span>

ax_legend<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_xticklabels<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"Low"</span><span class="token punctuation">,</span> <span class="token string">"Med"</span><span class="token punctuation">,</span> <span class="token string">"High"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_yticklabels<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"Low"</span><span class="token punctuation">,</span> <span class="token string">"Med"</span><span class="token punctuation">,</span> <span class="token string">"High"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

ax_legend<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span>X <span class="token operator">+</span> <span class="token string">" ‚Üí"</span><span class="token punctuation">,</span> labelpad<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span>Y <span class="token operator">+</span> <span class="token string">" ‚Üë"</span><span class="token punctuation">,</span> labelpad<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token comment"># Remove spines</span>
<span class="token keyword">for</span> spine <span class="token keyword">in</span> ax_legend<span class="token punctuation">.</span>spines<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    spine<span class="token punctuation">.</span>set_visible<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [55]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python">VAR <span class="token operator">=</span> <span class="token string">"LST_mean"</span>

ax <span class="token operator">=</span> tracts_clip<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>
    column<span class="token operator">=</span>VAR<span class="token punctuation">,</span>
    scheme<span class="token operator">=</span><span class="token string">"Quantiles"</span><span class="token punctuation">,</span>
    k<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>
    cmap<span class="token operator">=</span><span class="token string">"Reds"</span><span class="token punctuation">,</span>
    linewidth<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">,</span>
    edgecolor<span class="token operator">=</span><span class="token string">"white"</span><span class="token punctuation">,</span>
    legend<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Choropleth: Mean Land Surface Temperature (LST)"</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_axis_off<span class="token punctuation">(</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">"../outputs/Lab5_Fig1_LST_Choropleth.png"</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Saved Fig1_LST_Choropleth.png"</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [56]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">from</span> matplotlib<span class="token punctuation">.</span>patches <span class="token keyword">import</span> Rectangle

fig <span class="token operator">=</span> plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Main map</span>
ax_map <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_axes<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
tracts_clip<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>color<span class="token operator">=</span>tracts_clip<span class="token punctuation">[</span><span class="token string">"bi_color"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> linewidth<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">"white"</span><span class="token punctuation">,</span> ax<span class="token operator">=</span>ax_map<span class="token punctuation">)</span>
ax_map<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Bivariate Map: Tree Canopy (X) vs LST (Y)"</span><span class="token punctuation">)</span>
ax_map<span class="token punctuation">.</span>set_axis_off<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Legend</span>
ax_legend <span class="token operator">=</span> fig<span class="token punctuation">.</span>add_axes<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.78</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.18</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
N <span class="token operator">=</span> <span class="token number">3</span>
<span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
        idx <span class="token operator">=</span> y <span class="token operator">*</span> N <span class="token operator">+</span> x
        ax_legend<span class="token punctuation">.</span>add_patch<span class="token punctuation">(</span>Rectangle<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> facecolor<span class="token operator">=</span>palette<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">,</span> edgecolor<span class="token operator">=</span><span class="token string">"none"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

ax_legend<span class="token punctuation">.</span>set_xlim<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_ylim<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_aspect<span class="token punctuation">(</span><span class="token string">"equal"</span><span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_xticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_yticks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">2.5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_xticklabels<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"Low"</span><span class="token punctuation">,</span> <span class="token string">"Med"</span><span class="token punctuation">,</span> <span class="token string">"High"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_yticklabels<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"Low"</span><span class="token punctuation">,</span> <span class="token string">"Med"</span><span class="token punctuation">,</span> <span class="token string">"High"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_xlabel<span class="token punctuation">(</span><span class="token string">"Tree_mean ‚Üí"</span><span class="token punctuation">)</span>
ax_legend<span class="token punctuation">.</span>set_ylabel<span class="token punctuation">(</span><span class="token string">"LST_mean ‚Üë"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> spine <span class="token keyword">in</span> ax_legend<span class="token punctuation">.</span>spines<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    spine<span class="token punctuation">.</span>set_visible<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">"../outputs/Lab5_Fig2_Bivariate.png"</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Saved Lab5_Fig2_Bivariate.png"</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [57]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">from</span> shapely<span class="token punctuation">.</span>affinity <span class="token keyword">import</span> scale
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

CART_FIELD <span class="token operator">=</span> <span class="token string">"LST_mean"</span>
vals <span class="token operator">=</span> tracts_clip<span class="token punctuation">[</span>CART_FIELD<span class="token punctuation">]</span><span class="token punctuation">.</span>to_numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>
factors <span class="token operator">=</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>vals <span class="token operator">/</span> np<span class="token punctuation">.</span>nanmean<span class="token punctuation">(</span>vals<span class="token punctuation">)</span><span class="token punctuation">)</span>

scaled_geoms <span class="token operator">=</span> <span class="token punctuation">[</span>scale<span class="token punctuation">(</span>geom<span class="token punctuation">,</span> xfact<span class="token operator">=</span>f<span class="token punctuation">,</span> yfact<span class="token operator">=</span>f<span class="token punctuation">,</span> origin<span class="token operator">=</span><span class="token string">"center"</span><span class="token punctuation">)</span> <span class="token keyword">for</span> geom<span class="token punctuation">,</span> f <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>tracts_clip<span class="token punctuation">.</span>geometry<span class="token punctuation">,</span> factors<span class="token punctuation">)</span><span class="token punctuation">]</span>

gdf_scaled <span class="token operator">=</span> tracts_clip<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
gdf_scaled<span class="token punctuation">[</span><span class="token string">"geometry_scaled"</span><span class="token punctuation">]</span> <span class="token operator">=</span> scaled_geoms
gdf_scaled <span class="token operator">=</span> gdf_scaled<span class="token punctuation">.</span>set_geometry<span class="token punctuation">(</span><span class="token string">"geometry_scaled"</span><span class="token punctuation">)</span>

ax <span class="token operator">=</span> gdf_scaled<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>
    column<span class="token operator">=</span>CART_FIELD<span class="token punctuation">,</span>
    scheme<span class="token operator">=</span><span class="token string">"Quantiles"</span><span class="token punctuation">,</span>
    k<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>
    cmap<span class="token operator">=</span><span class="token string">"Reds"</span><span class="token punctuation">,</span>
    linewidth<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>
    edgecolor<span class="token operator">=</span><span class="token string">"white"</span><span class="token punctuation">,</span>
    legend<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Non-contiguous Cartogram (Scaled) by Mean LST"</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_axis_off<span class="token punctuation">(</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">"../outputs/Lab5_Fig3_NonContigCartogram.png"</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Saved Lab5_Fig3_NonContigCartogram.png"</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [58]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"><span class="token keyword">import</span> cartogram
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

CART_FIELD <span class="token operator">=</span> <span class="token string">"LST_mean"</span>

<span class="token comment"># Create the contiguous cartogram</span>
c <span class="token operator">=</span> cartogram<span class="token punctuation">.</span>Cartogram<span class="token punctuation">(</span>
    tracts_clip<span class="token punctuation">,</span>
    CART_FIELD<span class="token punctuation">,</span>
    max_iterations<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">,</span>
    max_average_error<span class="token operator">=</span><span class="token number">0.05</span>
<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Average cartogram error:"</span><span class="token punctuation">,</span> c<span class="token punctuation">.</span>average_error<span class="token punctuation">)</span>

<span class="token comment"># Plot the cartogram</span>
ax <span class="token operator">=</span> c<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>
    column<span class="token operator">=</span>CART_FIELD<span class="token punctuation">,</span>
    scheme<span class="token operator">=</span><span class="token string">"Quantiles"</span><span class="token punctuation">,</span>
    k<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>
    cmap<span class="token operator">=</span><span class="token string">"Reds"</span><span class="token punctuation">,</span>
    linewidth<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>
    edgecolor<span class="token operator">=</span><span class="token string">"white"</span><span class="token punctuation">,</span>
    legend<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
    figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string">"Cartogram: Tracts Distorted by Mean LST"</span><span class="token punctuation">)</span>
ax<span class="token punctuation">.</span>set_axis_off<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># Export the plot as PNG</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">"../outputs/Lab5_Fig3_Cartogram.png"</span><span class="token punctuation">,</span> dpi<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Saved Lab5_Fig3_Cartogram.png"</span><span class="token punctuation">)</span>

<span class="token comment"># Optional: Save the cartogram as a GeoPackage</span>
c<span class="token punctuation">.</span>to_file<span class="token punctuation">(</span><span class="token string">"../outputs/Lab5_Cartogram.gpkg"</span><span class="token punctuation">,</span> layer<span class="token operator">=</span><span class="token string">"cartogram"</span><span class="token punctuation">,</span> driver<span class="token operator">=</span><span class="token string">"GPKG"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Saved cartogram GeoPackage to outputs folder"</span><span class="token punctuation">)</span>
</code></pre>
                                            </div>
                                        </div>
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [59]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre class="language-python" tabindex="0"><code class="language-python"></code></pre>
                                            </div>
                                        </div></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="5.2.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Data inspection output: CRS + columns + head() + basic missing-value check</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="5.3.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Univariate choropleth map + notes on the scheme (e.g., Quantiles, k=5) and the field mapped</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="5.4.2.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p>Bivariate choropleth map + bivariate legend/key</p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div><div class="gallery-item" data-type="standard" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                <div class="img-container">
                        <img class="viz-source" src="5.5.png" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden="" onchange="updateCardImage(this)"></label>
                   </div>
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p><strong style="background-color: rgba(255, 255, 100, 0.1);">Cartogram map + the field used to distort area (and average_error if using cartogram)</strong></p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>Description...</p></div>
                    
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üìä Good vs Bad Viz</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üìñ Reading Reflections</div>
                <div class="gallery-grid"><div class="gallery-item" data-type="text" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)"><p><strong>6.Code-reading questions</strong></p></h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p class="ql-align-justify"><strong>Part 1</strong></p><p class="ql-align-justify"><strong>7. What does CRS mean, and why does it matter for mapping and area-based distortion? </strong></p><p class="ql-align-justify">Coordinate Reference System (CRS) defines the spatial data‚Äôs coordinates, in fact the location of data. It is important because different layers must share the same CRS to align correctly, and projected CRSs either in meters or feet are necessary for accurate area measurements and meaningful polygon distortion in cartograms. In my own experience, when I first ran the code, I didn‚Äôt get the correct results because the raster and polygon layers were in different CRSs, so they didn‚Äôt align properly until I reprojected them to a common CRS.</p><p class="ql-align-justify"><strong>8. What does gdf.total_bounds return, and how would you use it to sanity-check your data? </strong></p><p class="ql-align-justify">gdf.total_bounds returns the minimum and maximum x and y coordinates of all the geometries in a GeoDataFrame as [minx, miny, maxx, maxy]. I used it in my project to quickly check whether my tracts and study area were in the correct location and roughly matched the expected extent of Mecklenburg County. At first, I noticed the bounds didn‚Äôt make sense, which tipped me off that my layers were in different CRSs before I reprojected them.</p><p class="ql-align-justify"><strong>9. Which line reprojects the data, and what would happen if WORK_EPSG is invalid?</strong></p><p class="ql-align-justify">The line is ‚Äútracts_m = tracts.to_crs(WORK_EPSG)‚Äù, it changes the CRS of the GeoDataFrame to the working projection (WORK_EPSG). If WORK_EPSG is invalid, Python will produce an error, the data will not be reprojected, and any subsequent analysis (like overlaying layers, calculating areas, or creating cartograms) will fail or give incorrect results. In my case, using an incorrect CRS initially caused my layers not to align, and I had to fix the EPSG code before proceeding.</p><p class="ql-align-justify"><strong>&nbsp;</strong></p><p class="ql-align-justify"><strong>Part 2</strong></p><p class="ql-align-justify"><strong>10. Which parameter controls the number of classes (bins)? </strong></p><p class="ql-align-justify">The <strong>k</strong> parameter controls the number of classes (bins) in the choropleth. For example, <strong>k=5 </strong>divides the data into five bins based on the chosen classification scheme. I noticed that if the data has very few unique values, k may be automatically reduced, which happened when my LST data had many repeated values.</p><p class="ql-align-justify"><strong>11. Which parameter changes the color palette? Give two valid cmap examples. </strong></p><p class="ql-align-justify">The <strong>cmap</strong> parameter sets the color palette for the map. Two examples of valid color maps are "Blues" and "Reds". I experimented with both for my LST and Tree Cover maps to see which made patterns clearer visually.</p><p class="ql-align-justify"><strong>12. Which parameters control polygon boundary appearance (color and line width)? </strong></p><p class="ql-align-justify"><strong>edgecolor</strong> controls the boundary color, and linewidth controls the thickness of polygon edges. In my maps, I used <strong>edgecolor="white"</strong> and <strong>linewidth=0.3</strong> to make tract boundaries clear but not too visually dominant.</p><p class="ql-align-justify"><strong>13. What does scheme='Quantiles' mean, and how is it different from 'EqualInterval'?</strong></p><p class="ql-align-justify"><strong>scheme='Quantiles'</strong> divides the data into classes that each contain roughly the same number of features, so each bin has an equal count of tracts. In contrast, <strong>'EqualInterval'</strong> divides the data range into equal numeric intervals, which can result in bins with very different numbers of tracts. In my experience, Quantiles worked better for LST because some tracts had similar values and I wanted evenly distributed classes.</p><p class="ql-align-justify"><strong>Part 3</strong></p><p class="ql-align-justify"><strong>14. What does pd.qcut do, and why might duplicates='drop' be necessary? </strong></p><p class="ql-align-justify"><strong>pd.qcut</strong> divides a numeric variable into quantile-based bins, so that each bin contains approximately the same number of observations. The argument <strong>duplicates='drop'</strong> is needed when the data has repeated or tied values that would prevent creating the exact number of bins requested. In my dataset, some tracts had identical Tree Cover values, so this option avoided errors.</p><p class="ql-align-justify"><strong>15. How is bi_class computed? Explain the formula in one sentence. </strong></p><p class="ql-align-justify">bi_class is computed as y_bin * N + x_bin, which combines the row (Y variable) and column (X variable) bin indices into a single integer representing each bivariate class.</p><p class="ql-align-justify"><strong>16. Which lines would you change to switch from a 3x3 to a 4x4 bivariate map?</strong></p><p class="ql-align-justify">In your workflow, the bivariate map bins are created with these lines:</p><p class="ql-align-justify"><em>N = 3</em></p><p class="ql-align-justify"><em>tracts_clip["x_bin"] = pd.qcut(tracts_clip[X], N, labels=False, duplicates="drop")</em></p><p class="ql-align-justify"><em>tracts_clip["y_bin"] = pd.qcut(tracts_clip[Y], N, labels=False, duplicates="drop")</em></p><p class="ql-align-justify">&nbsp;</p><p class="ql-align-justify">To switch from 3√ó3 to 4√ó4, I would change N = 3 to N = 4 and recalculate x_bin and y_bin using pd.qcut. I would also create a new 16-color palette to match the 4√ó4 classification.</p><p class="ql-align-justify"><strong>&nbsp;</strong></p><p class="ql-align-justify"><strong>17. Which variable controls the colors used for the map?</strong></p><p class="ql-align-justify">In the workflow, the variable that actually determines the colors is: tracts_clip["bi_color"]</p><p class="ql-align-justify">These variable maps the bi_class values to the colors in your palette, so the color=tracts_clip["bi_color"] argument in tracts_clip.plot() sets the polygon colors on the map.</p><p class="ql-align-justify"><strong>&nbsp;</strong></p><p class="ql-align-justify"><strong>Part 4</strong></p><p class="ql-align-justify"><strong>18. Why must the cartogram field be positive? </strong></p><p class="ql-align-justify">I made sure the CART_FIELD (LST_mean) values were positive because cartogram distortion relies on scaling polygons proportionally to the numeric values. Negative or zero values would break the geometry scaling and produce invalid or inverted polygons.</p><p class="ql-align-justify"><strong>19. What do max_iterations and max_average_error control? </strong></p><p class="ql-align-justify">I set max_iterations=60 and max_average_error=0.05 to control how long the cartogram algorithm runs and how much distortion error is allowed. More iterations let the polygons adjust better, while a lower error threshold ensures the final map closely reflects the data.</p><p class="ql-align-justify"><strong>20. What is c.average_error measuring (in plain language)? </strong></p><p class="ql-align-justify">The c.average_error measures how closely the distorted polygon areas match the intended values from CART_FIELD. It means, it tells me how accurate the cartogram is, the smaller the error, the better the map represents the data.</p><p class="ql-align-justify"><strong>21. In the fallback method, why do we use sqrt(value/mean) rather than value/mean directly?</strong></p><p class="ql-align-justify">I learned that using sqrt (value/mean) smooths the scaling, preventing extreme distortion of very large or very small values. It gives a more visually balanced cartogram, avoiding overly stretched or shrunken polygons.</p><p><br></p></div>
                    
                    <div class="notebook-wrapper"></div>
                </div>
            </div></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'text')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üöÄ Project Progress</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
                <div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">üí¨ Peer Review &amp; Extras</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, 'standard')">+ Add Item</div>
            </div>
            </div></div>
            <div class="add-area-big" onclick="addWeek()">
                <h2>+ Add New Week</h2>
            </div>
        </div>

        <div id="maps" class="page-section">
            <h1 class="editable-field" onclick="openEditor(this)">Interactive Maps</h1>
            <div id="maps-container"></div>
            <div class="add-area-big" onclick="addMapItem()">
                <h2>+ Add New Map Section</h2>
            </div>
        </div>

        <div id="about" class="page-section">
            <h1 class="editable-field" onclick="openEditor(this)">About Me</h1>
            <div id="about-container" class="editable-field desc-text" onclick="openEditor(this)"><p>My name is Pegah, and I am a PhD student in Geography. Through this course, I expect to enhance my knowledge of geovisualization and improve how I present and interpret my research findings. My goal is to produce clearer and more meaningful visual outcomes that communicate the significance of my research more effectively.</p><p>I primarily use RStudio as a programming tool and ArcGIS Pro for visualization. I plan to apply geovisualization techniques extensively in my academic research, journal articles, and PhD dissertation.</p><p>
            </p></div>
        </div>
    </div>

    <div class="modal-overlay" id="vizModal" onclick="closeModal()">
        <div class="close-btn" onclick="closeModal()">√ó</div>
        <div class="modal-card text-only-mode" onclick="event.stopPropagation()">
            <div class="modal-viz"><img id="modal-img" src="file:///C:/GEOG2026/GeoViz_Live/5.3.png"></div>
            <div class="modal-text">
                <h2 id="modal-title" style="margin-top:0;">6.Code-reading questions</h2>
                <div id="modal-desc" class="desc-text"><p class="ql-align-justify"><strong>Part 1</strong></p><p class="ql-align-justify"><strong>7. What does CRS mean, and why does it matter for mapping and area-based distortion? </strong></p><p class="ql-align-justify">Coordinate Reference System (CRS) defines the spatial data‚Äôs coordinates, in fact the location of data. It is important because different layers must share the same CRS to align correctly, and projected CRSs either in meters or feet are necessary for accurate area measurements and meaningful polygon distortion in cartograms. In my own experience, when I first ran the code, I didn‚Äôt get the correct results because the raster and polygon layers were in different CRSs, so they didn‚Äôt align properly until I reprojected them to a common CRS.</p><p class="ql-align-justify"><strong>8. What does gdf.total_bounds return, and how would you use it to sanity-check your data? </strong></p><p class="ql-align-justify">gdf.total_bounds returns the minimum and maximum x and y coordinates of all the geometries in a GeoDataFrame as [minx, miny, maxx, maxy]. I used it in my project to quickly check whether my tracts and study area were in the correct location and roughly matched the expected extent of Mecklenburg County. At first, I noticed the bounds didn‚Äôt make sense, which tipped me off that my layers were in different CRSs before I reprojected them.</p><p class="ql-align-justify"><strong>9. Which line reprojects the data, and what would happen if WORK_EPSG is invalid?</strong></p><p class="ql-align-justify">The line is ‚Äútracts_m = tracts.to_crs(WORK_EPSG)‚Äù, it changes the CRS of the GeoDataFrame to the working projection (WORK_EPSG). If WORK_EPSG is invalid, Python will produce an error, the data will not be reprojected, and any subsequent analysis (like overlaying layers, calculating areas, or creating cartograms) will fail or give incorrect results. In my case, using an incorrect CRS initially caused my layers not to align, and I had to fix the EPSG code before proceeding.</p><p class="ql-align-justify"><strong>&nbsp;</strong></p><p class="ql-align-justify"><strong>Part 2</strong></p><p class="ql-align-justify"><strong>10. Which parameter controls the number of classes (bins)? </strong></p><p class="ql-align-justify">The <strong>k</strong> parameter controls the number of classes (bins) in the choropleth. For example, <strong>k=5 </strong>divides the data into five bins based on the chosen classification scheme. I noticed that if the data has very few unique values, k may be automatically reduced, which happened when my LST data had many repeated values.</p><p class="ql-align-justify"><strong>11. Which parameter changes the color palette? Give two valid cmap examples. </strong></p><p class="ql-align-justify">The <strong>cmap</strong> parameter sets the color palette for the map. Two examples of valid color maps are "Blues" and "Reds". I experimented with both for my LST and Tree Cover maps to see which made patterns clearer visually.</p><p class="ql-align-justify"><strong>12. Which parameters control polygon boundary appearance (color and line width)? </strong></p><p class="ql-align-justify"><strong>edgecolor</strong> controls the boundary color, and linewidth controls the thickness of polygon edges. In my maps, I used <strong>edgecolor="white"</strong> and <strong>linewidth=0.3</strong> to make tract boundaries clear but not too visually dominant.</p><p class="ql-align-justify"><strong>13. What does scheme='Quantiles' mean, and how is it different from 'EqualInterval'?</strong></p><p class="ql-align-justify"><strong>scheme='Quantiles'</strong> divides the data into classes that each contain roughly the same number of features, so each bin has an equal count of tracts. In contrast, <strong>'EqualInterval'</strong> divides the data range into equal numeric intervals, which can result in bins with very different numbers of tracts. In my experience, Quantiles worked better for LST because some tracts had similar values and I wanted evenly distributed classes.</p><p class="ql-align-justify"><strong>Part 3</strong></p><p class="ql-align-justify"><strong>14. What does pd.qcut do, and why might duplicates='drop' be necessary? </strong></p><p class="ql-align-justify"><strong>pd.qcut</strong> divides a numeric variable into quantile-based bins, so that each bin contains approximately the same number of observations. The argument <strong>duplicates='drop'</strong> is needed when the data has repeated or tied values that would prevent creating the exact number of bins requested. In my dataset, some tracts had identical Tree Cover values, so this option avoided errors.</p><p class="ql-align-justify"><strong>15. How is bi_class computed? Explain the formula in one sentence. </strong></p><p class="ql-align-justify">bi_class is computed as y_bin * N + x_bin, which combines the row (Y variable) and column (X variable) bin indices into a single integer representing each bivariate class.</p><p class="ql-align-justify"><strong>16. Which lines would you change to switch from a 3x3 to a 4x4 bivariate map?</strong></p><p class="ql-align-justify">In your workflow, the bivariate map bins are created with these lines:</p><p class="ql-align-justify"><em>N = 3</em></p><p class="ql-align-justify"><em>tracts_clip["x_bin"] = pd.qcut(tracts_clip[X], N, labels=False, duplicates="drop")</em></p><p class="ql-align-justify"><em>tracts_clip["y_bin"] = pd.qcut(tracts_clip[Y], N, labels=False, duplicates="drop")</em></p><p class="ql-align-justify">&nbsp;</p><p class="ql-align-justify">To switch from 3√ó3 to 4√ó4, I would change N = 3 to N = 4 and recalculate x_bin and y_bin using pd.qcut. I would also create a new 16-color palette to match the 4√ó4 classification.</p><p class="ql-align-justify"><strong>&nbsp;</strong></p><p class="ql-align-justify"><strong>17. Which variable controls the colors used for the map?</strong></p><p class="ql-align-justify">In the workflow, the variable that actually determines the colors is: tracts_clip["bi_color"]</p><p class="ql-align-justify">These variable maps the bi_class values to the colors in your palette, so the color=tracts_clip["bi_color"] argument in tracts_clip.plot() sets the polygon colors on the map.</p><p class="ql-align-justify"><strong>&nbsp;</strong></p><p class="ql-align-justify"><strong>Part 4</strong></p><p class="ql-align-justify"><strong>18. Why must the cartogram field be positive? </strong></p><p class="ql-align-justify">I made sure the CART_FIELD (LST_mean) values were positive because cartogram distortion relies on scaling polygons proportionally to the numeric values. Negative or zero values would break the geometry scaling and produce invalid or inverted polygons.</p><p class="ql-align-justify"><strong>19. What do max_iterations and max_average_error control? </strong></p><p class="ql-align-justify">I set max_iterations=60 and max_average_error=0.05 to control how long the cartogram algorithm runs and how much distortion error is allowed. More iterations let the polygons adjust better, while a lower error threshold ensures the final map closely reflects the data.</p><p class="ql-align-justify"><strong>20. What is c.average_error measuring (in plain language)? </strong></p><p class="ql-align-justify">The c.average_error measures how closely the distorted polygon areas match the intended values from CART_FIELD. It means, it tells me how accurate the cartogram is, the smaller the error, the better the map represents the data.</p><p class="ql-align-justify"><strong>21. In the fallback method, why do we use sqrt(value/mean) rather than value/mean directly?</strong></p><p class="ql-align-justify">I learned that using sqrt (value/mean) smooths the scaling, preventing extreme distortion of very large or very small values. It gives a more visually balanced cartogram, avoiding overly stretched or shrunken polygons.</p><p><br></p></div>
                <div id="modal-notebook-area" style="display:none; margin-top:20px; border-top:1px solid #eee; padding-top:20px;">
                    <h4 style="margin:0 0 10px 0;">Notebook Source:</h4>
                    <div id="modal-notebook-content" class="notebook-wrapper visible"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="controls">
        <button class="ctrl-btn btn-reset" onclick="resetLocalData()">‚ö†Ô∏è Reset</button>
        <button class="ctrl-btn btn-export" onclick="openExportModal()">‚ú® Export Gallery</button>
        <button class="ctrl-btn btn-edit" onclick="toggleEdit()" style="background: rgb(26, 26, 26);">‚úèÔ∏è Edit Mode</button>
        <button class="ctrl-btn btn-save" onclick="saveFile()">üíæ Save &amp; Download</button>
    </div>

    <script>
        let isEditing = false;
        let quill;
        let currentEditElement = null;

        // ===============================
        // FIXED: Stable autosave per file + unsaved changes warning
        // ===============================
        let dirtySinceManualSave = false;

        function generateId() {
            return (window.crypto && crypto.randomUUID)
                ? crypto.randomUUID()
                : ("id-" + Date.now() + "-" + Math.random().toString(16).slice(2));
        }

        // Stable mapping: same file (same URL) -> same portfolio-id
        function getUrlIdKey() {
            return `portfolio_id_by_url__${window.location.href}`;
        }

        function getOrCreateStableIdForThisFile() {
            const k = getUrlIdKey();
            let id = localStorage.getItem(k);
            if (!id) {
                id = generateId();
                localStorage.setItem(k, id);
            }
            return id;
        }

        function getPortfolioId() {
            let meta = document.querySelector('meta[name="portfolio-id"]');
            if (!meta) {
                meta = document.createElement('meta');
                meta.name = "portfolio-id";
                document.head.appendChild(meta);
            }

            const metaVal = (meta.content || "").trim();

            // If meta is empty, hydrate from stable per-file id
            if (!metaVal) {
                meta.content = getOrCreateStableIdForThisFile();
            } else {
                // If meta has an id, keep it as the canonical id for this file URL
                localStorage.setItem(getUrlIdKey(), metaVal);
            }

            return (meta.content || "").trim();
        }

        function getStorageKey() {
            return `portfolio_backup__${getPortfolioId()}`;
        }

        function markDirty() {
            dirtySinceManualSave = true;
        }

        window.onload = function () {
            quill = new Quill('#quill-container', {
                theme: 'snow',
                modules: {
                    toolbar: [
                        [{ 'header': [1, 2, 3, false] }],
                        ['bold', 'italic', 'underline', 'strike'],
                        [{ 'list': 'ordered' }, { 'list': 'bullet' }],
                        ['link', 'clean']
                    ]
                }
            });

            const hasRestored = restoreLocalData();
            if (!hasRestored && document.getElementById('timeline-container').children.length === 0) {
                addWeek();
            }
            Prism.highlightAll();
            setInterval(saveLocalData, 30000);

            // warn on close/refresh if changes since last manual download
            window.addEventListener('beforeunload', (e) => {
                if (dirtySinceManualSave) {
                    e.preventDefault();
                    e.returnValue = "";
                }
            });
        };

        // --- AUTOSAVE LOGIC (PER-FILE KEY) ---
        function saveLocalData() {
            const data = {
                timeline: document.getElementById('timeline-container').innerHTML,
                maps: document.getElementById('maps-container').innerHTML,
                about: document.getElementById('about-container').innerHTML,
                profile: document.getElementById('profile-container').innerHTML
            };
            localStorage.setItem(getStorageKey(), JSON.stringify(data));

            const toast = document.getElementById('autosave-toast');
            toast.classList.add('visible');
            setTimeout(() => toast.classList.remove('visible'), 5000);
        }

        function restoreLocalData() {
            const stored = localStorage.getItem(getStorageKey());
            if (stored) {
                try {
                    const data = JSON.parse(stored);
                    document.getElementById('timeline-container').innerHTML = data.timeline || "";
                    document.getElementById('maps-container').innerHTML = data.maps || "";
                    document.getElementById('about-container').innerHTML = data.about || "";
                    document.getElementById('profile-container').innerHTML = data.profile || "";
                    return true;
                } catch (e) { console.error("Error restoring data", e); }
            }
            return false;
        }

        function resetLocalData() {
            if (confirm("‚ö†Ô∏è Are you sure you want to clear autosave data for THIS HTML file? This will revert the page to default on reload.")) {
                localStorage.removeItem(getStorageKey());
                location.reload();
            }
        }

        function switchTab(tabId) {
            document.querySelectorAll('.page-section').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        // --- EDITOR LOGIC ---
        function openEditor(element) {
            if (!isEditing) return;
            currentEditElement = element;
            quill.root.innerHTML = element.innerHTML;
            document.getElementById('editor-modal').classList.add('active');
        }

        function closeEditor(save) {
            if (save && currentEditElement) {
                currentEditElement.innerHTML = quill.root.innerHTML;
                markDirty();
                saveLocalData();
            }
            document.getElementById('editor-modal').classList.remove('active');
            currentEditElement = null;
        }

        // --- EXPORT GALLERY LOGIC (WITH SMART MOSAIC) ---
        function openExportModal() {
            const grid = document.getElementById('export-grid-content');
            grid.innerHTML = '';
            const images = document.querySelectorAll('.gallery-item[data-type="standard"]');

            images.forEach((item) => {
                const imgEl = item.querySelector('.viz-source');
                const title = item.querySelector('.item-title').innerText;
                const thumb = document.createElement('div');
                thumb.className = 'export-item';
                thumb.onclick = function () { this.classList.toggle('selected'); };

                thumb.innerHTML = `<img src="${imgEl.src}"><div class="check-icon">‚úì</div><div style="position:absolute; bottom:0; background:rgba(0,0,0,0.7); color:white; width:100%; font-size:0.8rem; padding:5px; box-sizing:border-box;">${title}</div>`;

                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const imgObj = new Image();
                imgObj.crossOrigin = "Anonymous";
                imgObj.src = imgEl.src;

                thumb.dataset.title = title;
                thumb.dataset.desc = item.querySelector('.desc-text').innerHTML;
                thumb.dataset.originalSrc = imgEl.src;
                thumb.dataset.exportSrc = imgEl.src;
                thumb.dataset.ratio = 1.5;

                imgObj.onload = function () {
                    thumb.dataset.ratio = imgObj.width / imgObj.height;
                    canvas.width = imgObj.width;
                    canvas.height = imgObj.height;
                    ctx.drawImage(imgObj, 0, 0);
                    try { thumb.dataset.exportSrc = canvas.toDataURL('image/png'); } catch (e) { }
                }

                grid.appendChild(thumb);
            });
            document.getElementById('export-modal').classList.add('active');
        }

        function closeExportModal() { document.getElementById('export-modal').classList.remove('active'); }

        function generateGallery() {
            const selectedItems = document.querySelectorAll('.export-item.selected');
            if (selectedItems.length === 0) { alert("Please select at least one image."); return; }

            const layoutType = document.getElementById('export-layout').value;

            let galleryItemsHTML = '';
            const baseHeight = 400;

            selectedItems.forEach((item, index) => {
                const imgSrc = item.dataset.exportSrc || item.dataset.originalSrc;
                let styleStr = '';

                if (layoutType === 'dynamic') {
                    const ratio = parseFloat(item.dataset.ratio) || 1.5;
                    const growFactor = ratio * 100;
                    const flexBasis = Math.floor(baseHeight * ratio);
                    styleStr = `style="flex-grow: ${growFactor}; flex-basis: ${flexBasis}px;"`;
                }
const fileName = imgSrc.split('/').pop().split('?')[0].split('#')[0];
                galleryItemsHTML += `
                <div class="card gallery-card" id="card-${index}" data-img="${fileName}" ${styleStr}>
                    <div class="card-inner">
                        <img src="${fileName}" alt="Gallery Image">
                        <div class="card-content">
                            <h3>${item.dataset.title}</h3>
                            <div class="desc">${item.dataset.desc}</div>
                        </div>
                    </div>
                </div>`;
            });

            let containerCSS = '';
            let cardCSS = '';

            if (layoutType === 'uniform') {
                containerCSS = `display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 40px;`;
                cardCSS = `height: 400px; width: 100%;`;
            } else {
                containerCSS = `display: flex; flex-wrap: wrap; gap: 20px;`;
                cardCSS = `height: 40vh; min-height: 400px; max-width: 100%; position: relative;`;
            }

            const newFileContent = `<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Immersive Gallery</title>
<style>
    :root { --dark: #111; --light: #eee; --accent: #27ae60; }
    body { background-color: var(--dark); color: var(--light); font-family: 'Segoe UI', sans-serif; margin: 0; padding: 40px; overflow-x: hidden; perspective: 1000px; }
    .noise { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; opacity: 0.07; background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48ZmlsdGVyIGlkPSJnoiPjxmZVR1cmJ1bGVuY2UgdHlwZT0iZnJhY3RhbE5vaXNlIiBiYXNlRnJlcXVlbmN5PSIwLjY1IiBudW1PY3RhdmVzPSIzIiBzdGl0Y2hUaWxlcz0ic3RpdGNoIi8+PC9maWx0ZXI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsdGVyPSJ1cmwoI2cpIiBvcGFjaXR5PSIxIi8+PC9zdmc+'); }
    h1 { text-align: center; font-weight: 300; letter-spacing: 5px; margin-bottom: 60px; text-transform: uppercase; font-size: 3rem; text-shadow: 0 0 20px rgba(255,255,255,0.3); position: relative; z-index: 20; }
    .gallery-container { ${containerCSS} max-width: 1600px; margin: 0 auto; position: relative; z-index: 20; }
    .gallery-container::after { content: ''; flex-grow: 999999999; min-width: 200px; height: 0; }
    .card { ${cardCSS} background: transparent; perspective: 1000px; cursor: pointer; border-radius: 8px; overflow: hidden; }
    .card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1); transform-style: preserve-3d; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
    .card:hover .card-inner { transform: scale(0.98); box-shadow: 0 20px 40px rgba(0,0,0,0.8); }
    .card img { width: 100%; height: 100%; object-fit: cover; display: block; filter: brightness(0.9) contrast(1.1); transition: 0.5s; }
    .card:hover img { filter: brightness(1); transform: scale(1.02); }
    .card-content { position: absolute; bottom: 0; left: 0; width: 100%; padding: 25px; box-sizing: border-box; background: linear-gradient(to top, black 20%, transparent 100%); transform: translateZ(30px); opacity: 0; transition: 0.4s; pointer-events: none; }
    .card:hover .card-content { opacity: 1; transform: translateZ(50px) translateY(-10px); }
    h3 { margin: 0 0 5px 0; color: #fff; font-size: 1.4rem; letter-spacing: 1px; }
    .desc { font-size: 0.9rem; color: #ccc; max-height: 80px; overflow: hidden; }
    #lightbox { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.95); z-index: 10000; display: none; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s; }
    #lightbox.active { display: flex; opacity: 1; }
    .lb-content { width: 90vw; height: 85vh; background: #1a1a1a; border-radius: 12px; display: flex; overflow: hidden; box-shadow: 0 0 50px rgba(0,0,0,0.8); border: 1px solid #333; position: relative; }
    .lb-image-container { flex: 2; background: #000; display: flex; align-items: center; justify-content: center; padding: 20px; }
    .lb-image-container img { max-width: 100%; max-height: 100%; object-fit: contain; box-shadow: 0 0 30px rgba(0,0,0,0.5); }
    .lb-text-container { flex: 1; padding: 40px; overflow-y: auto; border-left: 1px solid #333; display: flex; flex-direction: column; }
    .lb-title { font-size: 2rem; margin-top: 0; color: var(--accent); margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 15px; }
    .lb-desc { font-size: 1.1rem; line-height: 1.6; color: #ddd; }
    .lb-desc p { margin-bottom: 1em; }
    .close-lb { position: absolute; top: 20px; right: 20px; color: white; font-size: 2.5rem; cursor: pointer; user-select: none; z-index: 100; line-height: 1; }
    .close-lb:hover { color: #e74c3c; transform: scale(1.1); transition: 0.2s; }
    @media (max-width: 900px) { .lb-content { flex-direction: column; height: 90vh; } .lb-image-container { flex: 1; } .lb-text-container { flex: 1; padding: 20px; } }
</style>
</head>
<body>
    <div class="noise"></div>
    <h1>Visuals & Reflections</h1>
    <div class="gallery-container">${galleryItemsHTML}</div>
    <div id="lightbox">
        <div class="lb-content">
            <div class="close-lb" id="close-btn">&times;</div>
            <div class="lb-image-container"><img id="lb-img" src=""></div>
            <div class="lb-text-container"><h2 id="lb-title" class="lb-title"></h2><div id="lb-desc" class="lb-desc"></div></div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const cards = document.querySelectorAll('.gallery-card');
            const lightbox = document.getElementById('lightbox');
            const closeBtn = document.getElementById('close-btn');
            cards.forEach(card => {
                card.addEventListener('click', () => {
                    const imgSrc = card.getAttribute('data-img');
                    const title = card.querySelector('h3').innerText;
                    const desc = card.querySelector('.desc').innerHTML;
                    document.getElementById('lb-img').src = imgSrc;
                    document.getElementById('lb-title').innerText = title;
                    document.getElementById('lb-desc').innerHTML = desc;
                    lightbox.classList.add('active');
                });
            });
            closeBtn.addEventListener('click', () => lightbox.classList.remove('active'));
            lightbox.addEventListener('click', (e) => { if(e.target === lightbox) lightbox.classList.remove('active'); });
        });
    <\/script>
</body>
</html>`;

            const blob = new Blob([newFileContent], { type: 'text/html' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = "GeoViz_Showcase.html";
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        // --- EXISTING UTILS ---
        function createCategory(title, type) {
            return `<div class="category-section">
                <div class="category-title editable-field" onclick="openEditor(this)">${title}</div>
                <div class="gallery-grid"></div>
                <div class="add-area-small" onclick="addGalleryItem(this, '${type}')">+ Add Item</div>
            </div>`;
        }

        function addWeek() {
            const weekNum = document.querySelectorAll('.week-block').length + 1;
            const weekId = 'week-' + weekNum;
            const weekTemplate = `<div class="week-block" id="${weekId}">
                <div class="week-header">
                    <h2 class="editable-field" onclick="openEditor(this)">Week ${weekNum}</h2>
                    <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è Delete Week</button>
                </div>
                ${createCategory("üíª Labs & Exercises", "standard")}
                ${createCategory("üìä Good vs Bad Viz", "standard")}
                ${createCategory("üìñ Reading Reflections", "text")}
                ${createCategory("üöÄ Project Progress", "standard")}
                ${createCategory("üí¨ Peer Review & Extras", "standard")}
            </div>`;
            document.getElementById('timeline-container').insertAdjacentHTML('beforeend', weekTemplate);

            const newWeek = document.getElementById('timeline-container').lastElementChild;
            newWeek.querySelectorAll('.add-area-small').forEach(btn => {
                const type = btn.getAttribute('onclick').includes("'text'") ? 'text' : 'standard';
                addGalleryItem(btn, type);
            });

            markDirty();
            saveLocalData();
        }

        function addGalleryItem(btnElement, type) {
            const targetGrid = btnElement.previousElementSibling;
            let imagePart = type === 'standard'
                ? `<div class="img-container">
                        <img class="viz-source" src="https://via.placeholder.com/600x400" alt="Viz">
                        <label class="file-upload-overlay">Change Img <input type="file" hidden onchange="updateCardImage(this)"></label>
                   </div>`
                : '';

            const template = `<div class="gallery-item" data-type="${type}" onclick="openModal(this)">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è</button>
                ${imagePart}
                <div class="item-data" onclick="if (isEditing) event.stopPropagation()">
                    <h3 class="editable-field item-title" onclick="openEditor(this)">Title</h3>
                    <div class="editable-field desc-text" onclick="openEditor(this)"><p>${type === 'text' ? 'Reflections...' : 'Description...'}</p></div>
                    ${type === 'standard' ? `
                        <div class="code-controls">
                            <div class="switch-wrapper">
                                <label class="switch"><input type="checkbox"><span class="slider"></span></label>
                                <span>Show NB in Modal</span>
                            </div>
                            <div class="upload-area"><input type="file" accept=".ipynb,.py" onchange="handleNotebookUpload(this)"></div>
                        </div>
                    ` : ''}
                    <div class="notebook-wrapper"></div>
                </div>
            </div>`;

            targetGrid.insertAdjacentHTML('beforeend', template);
            Prism.highlightAll();

            markDirty();
            saveLocalData();
        }

        function addMapItem() {
            const template = `<div class="map-wrapper">
                <button class="delete-btn" onclick="deleteElement(this, event)">üóëÔ∏è Delete Section</button>
                <h2 class="editable-field" onclick="openEditor(this)">New Map Title</h2>
                <div class="html-container">
                    <iframe src="about:blank"></iframe>
                    <label class="file-upload-overlay">
                        <div><h3>Select HTML File</h3><input type="file" onchange="updateMapFrame(this)"></div>
                    </label>
                </div>
                <div class="editable-field desc-text" onclick="openEditor(this)">Description...</div>
            </div>`;
            document.getElementById('maps-container').insertAdjacentHTML('beforeend', template);

            markDirty();
            saveLocalData();
        }

        function handleNotebookUpload(input) {
            const file = input.files[0];
            const wrapper = input.closest('.item-data').querySelector('.notebook-wrapper');
            const reader = new FileReader();
            reader.onload = function (e) {
                let content = e.target.result;
                wrapper.innerHTML = "";

                if (file.name.endsWith('.ipynb')) {
                    try {
                        const json = JSON.parse(content);
                        let count = 1;
                        if (json.cells) {
                            json.cells.forEach(cell => {
                                if (cell.cell_type === "code") {
                                    let sourceCode = Array.isArray(cell.source) ? cell.source.join("") : cell.source;
                                    wrapper.innerHTML += `
                                        <div class="nb-cell" style="display:flex; margin-bottom:10px;">
                                            <div style="width:40px; text-align:right; padding-right:10px;">In [${count}]:</div>
                                            <div style="flex-grow:1; background:#f7f7f7; padding:5px;">
                                                <pre><code class="language-python">${escapeHtml(sourceCode)}</code></pre>
                                            </div>
                                        </div>`;
                                    count++;
                                }
                            });
                        }
                    } catch (err) {
                        alert("Invalid .ipynb");
                    }
                } else {
                    wrapper.innerHTML = `<pre><code class="language-python">${escapeHtml(content)}</code></pre>`;
                }

                Prism.highlightAllUnder(wrapper);
                markDirty();
                saveLocalData();
            };
            reader.readAsText(file);
        }

        function escapeHtml(text) {
            return text.replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        function deleteElement(btn, event) {
            event.stopPropagation();

            // Prefer the *closest* meaningful container:
            // 1) gallery item (smallest scope)
            // 2) map section
            // 3) week block (largest scope)
            const galleryItem = btn.closest('.gallery-item');
            const mapWrapper = btn.closest('.map-wrapper');
            const weekBlock = btn.closest('.week-block');

            const target = galleryItem || mapWrapper || weekBlock;

            if (!target) {
                console.warn("Delete target not found.");
                return;
            }

            // Friendly label for confirm
            let label = "this item";
            if (target === weekBlock) label = "this week";
            else if (target === mapWrapper) label = "this map section";

            if (confirm(`Delete ${label}?`)) {
                target.remove();
                markDirty();
                saveLocalData();
            }
        }

        function toggleEdit() {
            isEditing = !isEditing;
            document.body.classList.toggle('editing');
            const btn = document.querySelector('.btn-edit');
            if (isEditing) {
                btn.innerText = "Done Editing";
                btn.style.background = "#27ae60";
            } else {
                btn.innerText = "‚úèÔ∏è Edit Mode";
                btn.style.background = "#1a1a1a";
            }
        }

        function openModal(trigger) {
            if (isEditing) return;
            const card = trigger.closest('.gallery-item');
            const type = card.getAttribute('data-type');

            document.getElementById('modal-title').innerText = card.querySelector('.item-title').innerText;
            document.getElementById('modal-desc').innerHTML = card.querySelector('.desc-text').innerHTML;

            if (type === 'text') {
                document.querySelector('.modal-card').classList.add('text-only-mode');
                document.getElementById('modal-notebook-area').style.display = "none";
            } else {
                document.querySelector('.modal-card').classList.remove('text-only-mode');
                document.getElementById('modal-img').src = card.querySelector('.viz-source').src;

                const isNbVisible = card.querySelector('input[type="checkbox"]')?.checked;
                document.getElementById('modal-notebook-area').style.display = isNbVisible ? "block" : "none";
                if (isNbVisible) {
                    document.getElementById('modal-notebook-content').innerHTML =
                        card.querySelector('.notebook-wrapper').innerHTML;
                }
            }
            document.getElementById('vizModal').classList.add('open');
        }

        function closeModal() { document.getElementById('vizModal').classList.remove('open'); }

        function updateSrc(input, imgId) {
            if (input.files[0]) {
                document.getElementById(imgId).src = input.files[0].name;
                markDirty();
                saveLocalData();
            }
        }

        function updateCardImage(input) {
            if (input.files[0]) {
                input.closest('.img-container').querySelector('.viz-source').src = input.files[0].name;
                markDirty();
                saveLocalData();
            }
        }

        function updateMapFrame(input) {
            if (input.files[0]) {
                input.closest('.html-container').querySelector('iframe').src = input.files[0].name;
                markDirty();
                saveLocalData();
            }
        }

        // NEW: Save & Download that prevents autosave from "messing up" other copies
        function saveFile() {
            if (isEditing) toggleEdit();

            // Preserve checkbox state in exported HTML
            document.querySelectorAll('input[type="checkbox"]').forEach(box => {
                if (box.checked) box.setAttribute('checked', 'checked');
                else box.removeAttribute('checked');
            });

            // Ask filename
            const currentPathName = (window.location.pathname || "");
            const currentFileName = (currentPathName.split('/').pop() || "").trim(); // works for file:// and http(s)
            const fallbackDefault = "GeoViz_Portfolio.html";
            const defaultName = currentFileName || fallbackDefault;

            const filename = (prompt("Filename to download:", defaultName) || defaultName).trim() || defaultName;

            // Decide exportId:
            // If user saves with a DIFFERENT filename than the currently opened file,
            // we ALWAYS create a new portfolio-id so autosave does NOT carry over.
            const currentId = getPortfolioId();
            const isSaveAsNewFile = (filename !== defaultName);

            const exportId = isSaveAsNewFile ? generateId() : currentId;

            // Ensure meta exists
            let meta = document.querySelector('meta[name="portfolio-id"]');
            if (!meta) {
                meta = document.createElement('meta');
                meta.name = "portfolio-id";
                document.head.appendChild(meta);
            }

            // Temporarily set meta to exportId for the exported HTML only
            const originalMeta = meta.content;
            meta.content = exportId;

            const htmlContent = "<!DOCTYPE html>\n<html lang='en'>" + document.documentElement.innerHTML + "</html>";

            // Restore current page meta so THIS page keeps its own autosave continuity
            meta.content = (originalMeta && originalMeta.trim()) ? originalMeta : currentId;

            // Download
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);

            // Mark manual save done (so close warning doesn't appear)
            dirtySinceManualSave = false;

            // IMPORTANT: do NOT seed localStorage for exportId.
            // The downloaded file already contains the current state in its HTML,
            // and seeding can make it look like it ‚Äúinherited‚Äù autosaves.
        }

    </script>



</body></html>